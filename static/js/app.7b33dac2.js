(function(t){function e(e){for(var a,n,c=e[0],r=e[1],l=e[2],u=0,d=[];u<c.length;u++)n=c[u],Object.prototype.hasOwnProperty.call(s,n)&&s[n]&&d.push(s[n][0]),s[n]=0;for(a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a]);h&&h(e);while(d.length)d.shift()();return o.push.apply(o,l||[]),i()}function i(){for(var t,e=0;e<o.length;e++){for(var i=o[e],a=!0,n=1;n<i.length;n++){var c=i[n];0!==s[c]&&(a=!1)}a&&(o.splice(e--,1),t=r(r.s=i[0]))}return t}var a={},n={app:0},s={app:0},o=[];function c(t){return r.p+"static/js/"+({about:"about"}[t]||t)+"."+{about:"55a1b384"}[t]+".js"}function r(e){if(a[e])return a[e].exports;var i=a[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.e=function(t){var e=[],i={about:1};n[t]?e.push(n[t]):0!==n[t]&&i[t]&&e.push(n[t]=new Promise((function(e,i){for(var a="static/css/"+({about:"about"}[t]||t)+"."+{about:"060bfd2c"}[t]+".css",s=r.p+a,o=document.getElementsByTagName("link"),c=0;c<o.length;c++){var l=o[c],u=l.getAttribute("data-href")||l.getAttribute("href");if("stylesheet"===l.rel&&(u===a||u===s))return e()}var d=document.getElementsByTagName("style");for(c=0;c<d.length;c++){l=d[c],u=l.getAttribute("data-href");if(u===a||u===s)return e()}var h=document.createElement("link");h.rel="stylesheet",h.type="text/css",h.onload=e,h.onerror=function(e){var a=e&&e.target&&e.target.src||s,o=new Error("Loading CSS chunk "+t+" failed.\n("+a+")");o.code="CSS_CHUNK_LOAD_FAILED",o.request=a,delete n[t],h.parentNode.removeChild(h),i(o)},h.href=s;var p=document.getElementsByTagName("head")[0];p.appendChild(h)})).then((function(){n[t]=0})));var a=s[t];if(0!==a)if(a)e.push(a[2]);else{var o=new Promise((function(e,i){a=s[t]=[e,i]}));e.push(a[2]=o);var l,u=document.createElement("script");u.charset="utf-8",u.timeout=120,r.nc&&u.setAttribute("nonce",r.nc),u.src=c(t);var d=new Error;l=function(e){u.onerror=u.onload=null,clearTimeout(h);var i=s[t];if(0!==i){if(i){var a=e&&("load"===e.type?"missing":e.type),n=e&&e.target&&e.target.src;d.message="Loading chunk "+t+" failed.\n("+a+": "+n+")",d.name="ChunkLoadError",d.type=a,d.request=n,i[1](d)}s[t]=void 0}};var h=setTimeout((function(){l({type:"timeout",target:u})}),12e4);u.onerror=u.onload=l,document.head.appendChild(u)}return Promise.all(e)},r.m=t,r.c=a,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(i,a,function(e){return t[e]}.bind(null,a));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/",r.oe=function(t){throw console.error(t),t};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],u=l.push.bind(l);l.push=e,l=l.slice();for(var d=0;d<l.length;d++)e(l[d]);var h=u;o.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"0a20":function(t,e,i){"use strict";i("0f1d")},"0cdd":function(t,e,i){},"0f1d":function(t,e,i){},1703:function(t,e,i){"use strict";i("346e")},"18ca":function(t,e,i){},"1c41":function(t,e,i){"use strict";i("a1bd")},2499:function(t,e,i){"use strict";i("9e6f")},"24b5":function(t,e,i){"use strict";i("d75e")},"24e3":function(t,e,i){"use strict";i("c9c7")},"2abe":function(t,e,i){"use strict";i("a96d")},3148:function(t,e,i){},"346e":function(t,e,i){},"3cc4":function(t,e,i){"use strict";i("8e49")},"433a":function(t,e,i){},5046:function(t,e,i){"use strict";i("c913")},"51bc":function(t,e,i){"use strict";i("926f")},5360:function(t,e,i){"use strict";i("94f9")},"56d7":function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d");var a=i("2b0e"),n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("transition",{attrs:{name:"slide",mode:"out-in"}},[i("router-view")],1),i("div",{directives:[{name:"show",rawName:"v-show",value:t.$store.state.isTabbarShow,expression:"$store.state.isTabbarShow"}],attrs:{id:"nav"}},[i("router-link",{attrs:{to:"/"}},[t._v("首页")]),i("router-link",{attrs:{to:"/salle"}},[t._v("大厅")]),i("router-link",{attrs:{to:"/delivery"}},[t._v("外卖")]),i("router-link",{attrs:{to:"/management"}},[t._v("后台")])],1)],1)},s=[],o={mounted:function(){},components:{}},c=o,r=(i("5c0b"),i("2877")),l=Object(r["a"])(c,n,s,!1,null,null,null),u=l.exports,d=(i("d3b7"),i("8c4f")),h=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},p=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"home"},[a("div",{attrs:{id:"pic"}},[a("img",{attrs:{alt:"Vue logo",src:i("7fc5")}})])])}],v={components:{},mounted:function(){}},f=v,g=(i("3cc4"),Object(r["a"])(f,h,p,!1,null,"7b2c5bf6",null)),m=g.exports,y=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"wrapper"},[t._l(t.tables,(function(e){return i("div",{key:e.tableNum,staticClass:"table",class:t.tableUsingList.includes(e.tableUrl)?"blue":"",attrs:{id:e.tableId},on:{click:function(i){return t.$router.push("/order/"+e.tableUrl)}}},[t._v(" "+t._s(e.tableNum)+" ")])})),i("div",{staticClass:"emporter",on:{click:function(e){return t.$router.push("/order/emporter")}}},[i("p",[t._v("打包")])])],2)])},_=[],k=(i("4160"),i("159b"),i("bc3a")),b=i.n(k),w={data:function(){return{tables:[{tableNum:"1",tableUrl:"1",tableId:"one"},{tableNum:"2-1",tableUrl:"21",tableId:"two-o"},{tableNum:"2-2",tableUrl:"22",tableId:"two-t"},{tableNum:"2-3",tableUrl:"23",tableId:"two-th"},{tableNum:"3-1",tableUrl:"31",tableId:"three-o"},{tableNum:"3-2",tableUrl:"32",tableId:"three-t"},{tableNum:"3-3",tableUrl:"33",tableId:"three-th"},{tableNum:"4-1",tableUrl:"41",tableId:"four-o"},{tableNum:"4-2",tableUrl:"42",tableId:"four-t"},{tableNum:"4-3",tableUrl:"43",tableId:"four-th"},{tableNum:"5-1",tableUrl:"51",tableId:"five-o"},{tableNum:"5-2",tableUrl:"52",tableId:"five-t"},{tableNum:"5-3",tableUrl:"53",tableId:"five-th"},{tableNum:"6",tableUrl:"6",tableId:"six"},{tableNum:"7-1",tableUrl:"71",tableId:"seven-o"},{tableNum:"7-2",tableUrl:"72",tableId:"seven-t"},{tableNum:"7-3",tableUrl:"73",tableId:"seven-th"},{tableNum:"8-1",tableUrl:"81",tableId:"eight-o"},{tableNum:"8-2",tableUrl:"82",tableId:"eight-t"},{tableNum:"8-3",tableUrl:"83",tableId:"eight-th"},{tableNum:"9-1",tableUrl:"91",tableId:"nine-o"},{tableNum:"9-2",tableUrl:"92",tableId:"nine-t"},{tableNum:"9-3",tableUrl:"93",tableId:"nine-th"},{tableNum:"9-4",tableUrl:"94",tableId:"nine-f"},{tableNum:"11",tableUrl:"11",tableId:"eleven"}],tableUsingList:[]}},mounted:function(){var t=this;b()({url:"/testtickets/"}).then((function(e){e.data.forEach((function(e){t.tableUsingList.push(e.table_num)})),console.log("已下单的桌号::::",t.tableUsingList)}))}},x=w,C=(i("8c61"),Object(r["a"])(x,y,_,!1,null,"47e8cfbb",null)),S=C.exports,T=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:t.$store.state.ticketShow||t.$store.state.payShow?"noscroll":""},[i("info"),i("div",{attrs:{id:"orderArea"}},[i("category",{attrs:{id:"category"}}),i("dish",{attrs:{id:"dish"}})],1),i("navbar",{directives:[{name:"show",rawName:"v-show",value:t.$store.state.orderNavShow,expression:"$store.state.orderNavShow"}]}),i("transition",{attrs:{name:"ticket"}},[i("ticket",{directives:[{name:"show",rawName:"v-show",value:t.$store.state.ticketShow,expression:"$store.state.ticketShow"}]})],1),i("transition",{attrs:{name:"ticket"}},[i("pay",{directives:[{name:"show",rawName:"v-show",value:t.$store.state.payShow,expression:"$store.state.payShow"}]})],1),i("button",{staticStyle:{display:"none"},on:{click:t.handleClick}},[t._v("测试")])],1)},D=[],$=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"info",attrs:{id:"info"}},[i("div",{staticClass:"nav_ele",attrs:{id:"home_page"}},[i("i",{staticClass:"iconfont icon-zuojiantou",on:{click:function(e){return t.$router.push("/salle/")}}})]),i("div",{staticClass:"nav_ele",attrs:{id:"table_num"}},[i("p",[t._v("桌号： ")]),i("p",{attrs:{id:"input_table_num"}},[t._v(t._s(t.$route.params.table_num))])]),i("div",{staticClass:"nav_ele",attrs:{id:"client_quantity"}},[i("p",[t._v("人数：")]),i("div",[i("button",{attrs:{id:"client_num_down",disabled:t.$store.state.table.ticketPersonQuantity<=1},on:{click:function(e){return t.handleClick("minus")}}},[t._v("-")]),i("input",{directives:[{name:"model",rawName:"v-model.number",value:t.$store.state.table.ticketPersonQuantity,expression:"$store.state.table.ticketPersonQuantity",modifiers:{number:!0}}],staticStyle:{color:"white"},attrs:{type:"number",id:"input_client_quantity"},domProps:{value:t.$store.state.table.ticketPersonQuantity},on:{input:function(e){e.target.composing||t.$set(t.$store.state.table,"ticketPersonQuantity",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),i("button",{attrs:{id:"client_num_up"},on:{click:function(e){return t.handleClick("add")}}},[t._v("+")])])]),t._m(0)])},O=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"nav_ele",attrs:{id:"client_num"}},[i("p",[t._v("客户：")]),i("div",[i("button",{attrs:{id:"client_num_down"}},[t._v("-")]),i("p",[t._v("1")]),i("button",{attrs:{id:"client_num_up"}},[t._v("+")])])])}],P={data:function(){return{tableNum:"",personQuantity:"",client:"1"}},mounted:function(){var t=this;b()({url:"/testticket/"+this.$route.params.table_num+"/"}).then((function(e){t.$store.commit("changeTableNum",t.$route.params.table_num)}))},methods:{handleClick:function(t){this.$store.commit("changeTicketPersonQuantity",t)}},watch:{}},N=P,j=(i("9e5c"),Object(r["a"])(N,$,O,!1,null,"c208c008",null)),L=j.exports,A=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("ul",t._l(t.categories,(function(e){return i("li",{key:e.category_id,class:[e.category_id==t.$store.state.categoryId?"categorySelect":"categoryNoselect"],on:{click:function(i){return t.changeCategory(e.category_id)}}},[i("p",[t._v(t._s(e.category))])])})),0)])},F=[],B={data:function(){return{categories:[]}},mounted:function(){var t=this;b()({url:"/testcategory/"}).then((function(e){t.categories=e.data}))},methods:{changeCategory:function(t){this.$store.commit("changeCategoryId",t)}}},E=B,I=(i("7838"),Object(r["a"])(E,A,F,!1,null,"4a6b85fe",null)),R=I.exports,H=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("ul",t._l(this.$store.state.dishes,(function(e){return i("li",{key:e.did,staticClass:"dish-detail"},[i("div",{attrs:{id:"firstline"}},[i("p",{staticStyle:{"font-weight":"bold"}},[t._v(t._s(e.dname))]),i("p",{directives:[{name:"show",rawName:"v-show",value:t.selectNum(e.dname),expression:"selectNum(data.dname)"}]},[t._v("已选 "+t._s(t.selectNum(e.dname)))])]),i("div",{attrs:{id:"secondline"}},[i("p",{staticStyle:{color:"#ff4a4a"}},[t._v(t._s(e.dprice))]),i("div",{staticClass:"quantity"},[i("button",{staticClass:"minus",style:{display:e.selecting>0?"block":"none"},on:{click:function(t){e.selecting-=1}}},[t._v("-")]),i("input",{staticClass:"dish_quantity",staticStyle:{"text-align":"center",width:"2em",color:"#ff4a4a"},style:{display:e.selecting>0?"block":"none"},attrs:{type:"number"},domProps:{value:e.selecting}}),i("button",{staticClass:"add",attrs:{value:"+"},on:{click:function(t){e.selecting+=1}}},[t._v("+")])])])])})),0)])},q=[];i("caad"),i("d81d"),i("b64b"),i("07ac"),i("2532");function M(t){b()({url:"/testemptyticket/".concat(t.$route.params.table_num,"/")}).then((function(t){return t.data[0].ticket_id})).catch((function(t){console.log("方法2获取tableId失败",t)}))}var z={data:function(){return{selectedDish:{}}},computed:{},methods:{handleScroll:function(t){console.log(this.$el.children[0].children[0].getBoundingClientRect().top),alert("dish页面发生滚动"+t.target.getBoundingClientRect().top)},selectNum:function(t){var e;return void 0!==this.$store.state.selectedDish.length?(this.$store.state.selectedDish.forEach((function(i,a){Object.keys(i).includes(t)&&(e=Object.values(i)[0].quantity)})),e):""},hancleClick:function(t){t.selecting+=1}},mounted:function(){var t=this;b()({url:"/testdish/".concat(this.$store.state.categoryId,"/")}).then((function(e){t.$store.commit("changeDishes",e.data),t.$store.commit("changeSelectingDish",t.$store.state.dishes)})),b()({url:"/testticketordergroupby/".concat(this.$route.params.table_num,"/")}).then((function(e){console.log("已选菜品groupBy：：：：",e.data),t.$store.commit("changeTicketDetail",e.data),e.data.length>0?t.$store.commit("changeTableId",e.data[0].tableid[0]):M(t)&&t.$store.commit("changeTableId",M(t)),t.$store.commit("changeSelectedDish",e.data)}))},watch:{"$store.state.categoryId":function(){var t=this;b()({url:"/testdish/".concat(this.$store.state.categoryId,"/")}).then((function(e){t.$store.state.dishes=e.data.map((function(t){return a["a"].set(t,"selecting",0),t})),t.$store.commit("changeSelectingDish",t.$store.state.dishes)}))},"$store.state.table.orderLength":function(){var t=this;b()({url:"/testticketordergroupby/".concat(this.$route.params.table_num,"/")}).then((function(e){t.$store.commit("changeTicketDetail",e.data),e.data.length>0&&t.$store.commit("changeTableId",e.data[0].tableid[0]),t.$store.state.selectedDish=e.data.map((function(t){var e={};return e[t.dname]={quantity:t.total_quantity[0],price:t.dprice,tax:t.dtax},e})),t.$store.state.dishes=t.$store.state.dishes.map((function(t){return a["a"].set(t,"selecting",0),t})),t.$store.commit("changeSelectingDish",t.$store.state.dishes)}))},"$store.state.table.selecteDish":function(){var t=this;b()({url:"/testticketordergroupby/".concat(this.$route.params.table_num,"/")}).then((function(e){console.log(e.data),t.$store.commit("changeTicketDetail",e.data),e.data.length>0?t.$store.commit("changeTableId",e.data[0].tableid[0]):M(t)&&t.$store.commit("changeTableId",M(t)),t.$store.state.selectedDish=e.data.map((function(t){var e={};return e[t.dname]={quantity:t.total_quantity[0],price:t.dprice,tax:t.dtax},e}))}))}}},W=z,U=(i("24b5"),Object(r["a"])(W,H,q,!1,null,"952f4e60",null)),J=U.exports,V=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"nav"},[i("div",{staticClass:"nva_bottom",attrs:{id:"confirm"},on:{click:t.handleSubmit}},[i("p",[t._v("添加")])]),i("div",{staticClass:"nav_icon"},[i("i",{staticClass:"iconfont icon-gouwuche",staticStyle:{"margin-left":"15px",border:"border-radius: 50%","font-size":"2em",color:"rgba(7, 17, 27, 0.5)","font-weight":"normal"},on:{click:t.handleTicketClick}}),i("i",{staticClass:"iconfont icon-jiezhang",staticStyle:{"margin-left":"15px",border:"2px solid white","border-radius":"50%","font-size":"2em",color:"rgba(7, 17, 27, 0.5)","font-weight":"bolder"},on:{click:t.handlePayClick}})])])},Q=[],Y=(i("25f0"),i("96cf"),i("1da1"));function G(t){t.$store.state.table.ticketPersonQuantity>1?(console.log("更新人数Navbar 19行"),b()({url:"/testpatchtable/".concat(t.$store.state.tableId,"/"),method:"PATCH",data:{person_quantity:t.$store.state.table.ticketPersonQuantity}}).then((function(t){console.log("修改人数后的回调：：：",t.data)}))):console.log("人数填写不标准，无法更新 Navbar 21行")}function Z(t){t.$store.state.selectingDish.forEach((function(e){if(console.log(e.selecting),e.selecting>0){var i=new Date,n=i.getFullYear().toString()+((i.getMonth()+1).toString().length<2?"0"+(i.getMonth()+1).toString():(i.getMonth()+1).toString())+i.getDate().toString()+(i.getHours().toString().length<2?"0"+i.getHours().toString():i.getHours().toString())+(i.getMinutes().toString().length<2?"0"+i.getMinutes().toString():i.getMinutes().toString())+(i.getSeconds().toString().length<2?"0"+i.getSeconds().toString():i.getSeconds().toString()),s={};a["a"].set(s,"order_id","D"+i.getTime().toString()+Math.floor(900*Math.random()+100).toString()),a["a"].set(s,"order_time",n),a["a"].set(s,"quantity",e.selecting),a["a"].set(s,"code",e.dcode),a["a"].set(s,"tid",t.$store.state.tableId),a["a"].set(s,"o_note","无备注"),console.log(JSON.stringify(s)),console.log(s),b()({url:"/testcreate/",method:"post",data:s}).then((function(e){console.log("tableNum:",t.$route.params.table_num),b()({url:"/testticket/".concat(t.$route.params.table_num,"/")}).then((function(e){t.$store.commit("changePersonQuantity",e.data),t.$store.commit("resetDishes",e.data),b()({url:"/testticketordergroupby/".concat(t.$route.params.table_num,"/")}).then((function(e){console.log(e.data),t.$store.commit("changeTicketDetail",e.data),t.$store.commit("changeSelectedDish",e.data)}))}))}))}}))}function K(t){console.log("开始创建新ticket");var e=new Date,i={};i.ticket_id="T"+e.getTime().toString(),i.ticket_time=e.getFullYear().toString()+((e.getMonth()+1).toString().length<2?"0"+(e.getMonth()+1).toString():(e.getMonth()+1).toString())+e.getDate().toString()+(e.getHours().toString().length<2?"0"+e.getHours().toString():e.getHours().toString())+(e.getMinutes().toString().length<2?"0"+e.getMinutes().toString():e.getMinutes().toString())+(e.getSeconds().toString().length<2?"0"+e.getSeconds().toString():e.getSeconds().toString()),t.$store.state.table.tableNum?i.table_num=t.$store.state.table.tableNum:i.table_num=t.$route.params.table_num;var a=t;console.log(i),b()({url:"/testcreatetable/",method:"post",data:i}).then((function(t){a.$store.state.tableId=t.data.ticket_id,G(a),Z(a)})).catch((function(t){console.log("创建ticket失败，原因：：：：：：：",t)}))}function X(t){b()({url:"/testemptyticket/".concat(t.$route.params.table_num,"/")}).then((function(t){return t.data[0].ticket_id})).catch((function(t){console.log("方法2获取tableId失败",t)}))}var tt={methods:{handleSubmit:function(){var t=this;console.log("点击添加"),this.$store.state.table.ticketDetail.length>0?(console.log("ticket已存在，开始添加order"),G(this),Z(this)):(console.log("由于ticketDetail为0，所以方法一没有检测到ticket"),b()({url:"/testemptyticket/".concat(this.$route.params.table_num,"/")}).then((function(e){console.log("(方法2)人数:::::::::::::::::",t.$store.state.table.ticketPersonQuantity),G(t),t.$store.state.table.ticketPersonQuantity&&console.log("发送一个patch personQuantity 请求（接下来写）"),e.data[0].ticket_id?(console.log("ticket已存在(方法2)，接下来给state.tableId赋值"),t.$store.commit("changeTableId",e.data[0].ticket_id),Z(t)):(console.log("单子不存在，创建新单"),K(t))})).catch((function(e){console.log("进入catch方法",e),K(t)})))},handleTicketClick:function(){var t=this;this.$store.commit("changeTicketShow"),b()({url:"/testticket/"+this.$route.params.table_num+"/"}).then((function(e){t.$store.commit("changeOrderDetail",e.data),t.$store.commit("changeChangingOrderDetail",e.data)}))},handlePayClick:function(){var t=this;function e(t){return i.apply(this,arguments)}function i(){return i=Object(Y["a"])(regeneratorRuntime.mark((function t(e){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,b()({url:"/testticketdetail/".concat(e.$route.params.table_num,"/")});case 2:i=t.sent,console.log(i.data),e.$store.commit("changePayCondition",i.data);case 5:case"end":return t.stop()}}),t)}))),i.apply(this,arguments)}this.$store.commit("changePayShow"),b()({url:"/testticketordergroupby/".concat(this.$route.params.table_num,"/")}).then((function(e){console.log("已选菜品groupBy：：：：",e.data),t.$store.commit("changeTicketDetail",e.data),e.data.length>0?t.$store.commit("changeTableId",e.data[0].tableid[0]):X(t)&&t.$store.commit("changeTableId",X(t)),t.$store.commit("changeSelectedDish",e.data)})),e(this)}}},et=tt,it=(i("2499"),Object(r["a"])(et,V,Q,!1,null,"deb6a5e6",null)),at=it.exports,nt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"outer2",attrs:{id:"ticket_list"}},[i("div",{staticStyle:{display:"flex","align-items":"center"}},[i("i",{staticClass:"iconfont icon-shangjiantou1",staticStyle:{"text-align":"right","margin-left":"0px",border:"2px solid white","border-radius":"50%","font-size":"2em",color:"black","font-weight":"bolder"},on:{click:t.handleTicketClick}}),i("p",[t._v("桌号："+t._s(t.$route.params.table_num))])]),i("div",{attrs:{id:"ordered_list"}},t._l(t.$store.state.table.changingOrderDetail,(function(e){return i("div",{key:e.order_id},[i("div",{staticClass:"order_container"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.checked,expression:"data.checked"}],staticClass:"check",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.checked)?t._i(e.checked,null)>-1:e.checked},on:{change:function(i){var a=e.checked,n=i.target,s=!!n.checked;if(Array.isArray(a)){var o=null,c=t._i(a,o);n.checked?c<0&&t.$set(e,"checked",a.concat([o])):c>-1&&t.$set(e,"checked",a.slice(0,c).concat(a.slice(c+1)))}else t.$set(e,"checked",s)}}}),i("div",{staticClass:"order"},[i("div",{staticClass:"dish_name"},[t._v(t._s(e.dname))]),i("input",{staticClass:"minus2",attrs:{type:"button",disabled:0===e.quantity,value:"-"},on:{click:function(t){e.quantity--}}}),i("input",{directives:[{name:"model",rawName:"v-model.number",value:e.quantity,expression:"data.quantity",modifiers:{number:!0}}],staticClass:"dish_quantity",attrs:{type:"number"},domProps:{value:e.quantity},on:{input:function(i){i.target.composing||t.$set(e,"quantity",t._n(i.target.value))},blur:function(e){return t.$forceUpdate()}}}),i("input",{staticClass:"add2",attrs:{type:"button",value:"+"},on:{click:function(t){e.quantity++}}}),i("div",{staticClass:"dish_note"},[t._v(t._s(e.note))])])])])})),0),i("div",{staticClass:"note",class:t.isShow?"indentation":"extention"},t._l(t.baseNoteList,(function(e){return i("p",{key:e.id,class:["note"+e.note_category_id,t.selectingNum.includes(e.id)?"checked":""],on:{click:function(i){return t.changeChecked(e.id,e.note_content)}}},[t._v(" "+t._s(e.note_content)+" ")])})),0),i("i",{staticClass:"iconfont icon-shangjiantou1",class:t.isShow?"down":"up",staticStyle:{"margin-left":"15px","border-radius":"50%","font-size":"1em",color:"black","font-weight":"bolder"},style:{transform:t.isShow?"rotate(180deg)":""},on:{click:function(e){t.isShow=!t.isShow}}}),i("div",{attrs:{id:"order_submit"}},[i("p",{on:{click:t.handleSubmit}},[t._v("提交")]),i("p",{on:{click:t.showPopup}},[t._v("删整单")])]),i("van-popup",{style:{height:"30%",width:"100%"},attrs:{id:"delete_submit",round:"",position:"bottom"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[i("p",{on:{click:t.deleteAll}},[t._v("删所有菜")]),i("p",{on:{click:t.deleteTable}},[t._v("删除桌子")])])],1)},st=[],ot=(i("c975"),i("a15b"),i("a434"),i("8a58"),i("e41f"));function ct(t,e){!0===t.$store.state.table.changingOrderDetail[e].checked&&(0!==t.selectingNoteContent.length?(console.log("note patch请求"),b()({url:"/testpatch/".concat(t.$store.state.table.changingOrderDetail[e].order_id,"/"),method:"PATCH",data:{o_note:t.selectingNoteContent.join(", ")}}).then((function(t){console.log("note patch请求成功")}))):console.log("由于this.selectingNoteContent为空，不执行note patch请求"))}function rt(t){console.log("刷新ticket页面"),b()({url:"/testticket/"+t.$route.params.table_num+"/"}).then((function(e){console.log(e.data),t.$store.commit("changeOrderDetail",e.data),t.$store.commit("changeChangingOrderDetail",e.data),console.log("order详情：：：：：：：：：：：",t.$store.state.table.orderDetail)}))}function lt(t){console.log("刷新order页面"),b()({url:"/testticketordergroupby/".concat(t.$route.params.table_num,"/")}).then((function(e){console.log(e.data),t.$store.commit("changeTicketDetail",e.data),t.$store.commit("changeSelectedDish",e.data)}))}a["a"].use(ot["a"]);var ut={data:function(){return{baseNoteList:[],selectedNote:[],selectingNum:[],selectingNoteContent:[],isShow:!0,show:!1}},mounted:function(){var t=this;b()({url:"/testbasenote/"}).then((function(e){t.baseNoteList=e.data,t.selectedNote=e.data.map((function(t){return a["a"].set(t,"selecting",!1),t}))}))},methods:{handleTicketClick:function(){var t=this;this.$store.commit("changeTicketShow"),b()({url:"/testticket/"+this.$route.params.table_num+"/"}).then((function(e){t.$store.commit("changeOrderDetail",e.data),t.$store.commit("changeChangingOrderDetail",e.data)}))},noteCategory:function(t){return{"data.note_category_id":!0}},changeChecked:function(t,e){console.log(e);var i=this.selectingNum.indexOf(t);-1!==i?this.selectingNum.splice(i,1):this.selectingNum.push(t);var a=this.selectingNoteContent.indexOf(e);console.log("current2::::::::",a),-1!==a?this.selectingNoteContent.splice(a,1):this.selectingNoteContent.push(e),console.log(this.selectingNoteContent)},handleSubmit:function(){var t=this;this.$store.state.table.changingOrderDetail.forEach((function(e,i){t.$store.state.table.changingOrderDetail[i].quantity===t.$store.state.table.orderDetail[i].quantity&&t.$store.state.table.changingOrderDetail[i].note===t.$store.state.table.orderDetail[i].note?(console.log("相等,无需patch"),ct(t,i)):(console.log("不相等，需判断是patch或delete"),0===t.$store.state.table.changingOrderDetail[i].quantity?(console.log("this.$store.state.table.changingOrderDetail[index].quantity:::::",t.$store.state.table.changingOrderDetail[i].quantity),console.log("delete请求"),b()({url:"/testpatch/".concat(t.$store.state.table.changingOrderDetail[i].order_id,"/"),method:"DELETE",data:{quantity:t.$store.state.table.changingOrderDetail[i].quantity}}).then((function(e){console.log(e.data),ct(t,i,rt,lt)}))):(console.log("patch请求"),b()({url:"/testpatch/".concat(t.$store.state.table.changingOrderDetail[i].order_id,"/"),method:"PATCH",data:{quantity:t.$store.state.table.changingOrderDetail[i].quantity}}).then((function(e){ct(t,i,rt,lt)}))))})),this.selectingNoteContent=[],this.selectingNum=[],console.log(this.selectingNoteContent),setTimeout((function(){rt(t),lt(t)}),100)},showPopup:function(){this.show=!0},deleteAll:function(){var t=this;this.$store.state.table.orderDetail.length>0&&this.$store.state.table.orderDetail.forEach((function(e){b()({url:"/testpatch/".concat(e.order_id,"/"),method:"DELETE"}).then((function(e){console.log("删除后的回调函数:::",e.data),b()({url:"/testticket/"+t.$route.params.table_num+"/"}).then((function(e){console.log(e.data),t.$store.commit("changeOrderDetail",e.data),t.$store.commit("changeChangingOrderDetail",e.data),lt(t)}))}))}))},deleteTable:function(){var t=this;b()({url:"/testpatchtable/".concat(this.$store.state.tableId,"/"),method:"DELETE"}).then((function(e){t.$router.push("/salle")})).catch((function(t){console.log(t.message)}))}},computed:{noteCategory2:function(){return function(t){return console.log(t.note_category_id),t.note_category_id}}}},dt=ut,ht=(i("5360"),Object(r["a"])(dt,nt,st,!1,null,"07f16e20",null)),pt=ht.exports,vt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"outer2"},[i("div",{staticClass:"header"},[i("i",{staticClass:"iconfont icon-shangjiantou1",staticStyle:{"text-align":"right","margin-left":"0px",border:"2px solid white","border-radius":"50%","font-size":"2em",color:"black","font-weight":"bolder"},on:{click:t.handlePayClick}}),i("p",[t._v("桌号："+t._s(t.$route.params.table_num))]),i("div",{staticClass:"payingAmount",on:{click:function(e){t.payingDishShow=!t.payingDishShow}}},[t._v("辅助："+t._s(t.payingAmount))])]),i("transition",{attrs:{name:"paying"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.payingDishShow,expression:"payingDishShow"}],staticClass:"payingDish"},[i("div",{staticStyle:{"text-align":"right","margin-right":"10px","font-size":"30px"},on:{click:function(e){t.payingDishShow=!t.payingDishShow}}},[t._v("x")]),i("div",{staticStyle:{display:"grid","grid-template-columns":"1fr 2fr","align-items":"center","border-bottom":"1px solid rgba(255, 255, 255, 0.5)"}},[i("p",{on:{click:function(e){t.payingList=[]}}},[t._v("重置")]),i("h3",{staticClass:"payingTotal"},[t._v("总："+t._s(t.payingAmount))])]),i("ul",{staticStyle:{"margin-top":"5px"}},t._l(t.payingList,(function(e){return i("li",{key:e.id,staticClass:"payingDetail",on:{click:function(i){return t.handlePayingDel(e)}}},[i("p",[t._v(t._s(e.name))]),i("p",[t._v(t._s(e.price))])])})),0)])]),i("div",{staticClass:"stickyArea"},[i("div",{attrs:{id:"total"}},[i("div",{attrs:{id:"tax10"}},[i("p",{staticClass:"taxTitle"},[t._v("10%")]),i("p",[t._v(t._s(t.tatalTax10))])]),i("div",{attrs:{id:"tax20"}},[i("p",{staticClass:"taxTitle"},[t._v("20%")]),t._v(" "+t._s(t.tatalTax20)+" ")]),i("div",{attrs:{id:"totalTax"}},[i("p",{staticClass:"taxTitle"},[t._v("总TVA")]),t._v(" "+t._s(t.tatalTax))]),i("h2",{attrs:{id:"totalPrice"}},[t._v("总："+t._s(t.totalPrice))])]),i("div",{staticClass:"detailArea"},[i("div",{staticClass:"detail",staticStyle:{color:"#2CA4B0"}},[i("p",{staticClass:"title"},[t._v("转账")]),i("p",{staticClass:"amount"},[t._v(t._s(t.$store.state.payCondition.virement))])]),i("div",{staticClass:"detail",staticStyle:{color:"#ff4a4a"}},[i("p",{staticClass:"title"},[t._v("现金")]),i("p",{staticClass:"amount"},[t._v(t._s(t.$store.state.payCondition.cash))])]),i("div",{staticClass:"detail",staticStyle:{color:"#217969"}},[i("p",{staticClass:"title"},[t._v("饭票")]),i("p",{staticClass:"amount"},[t._v(t._s(t.$store.state.payCondition.ticket))])]),i("div",{staticClass:"detail",staticStyle:{color:"#b48608"}},[i("p",{staticClass:"title"},[t._v("刷卡")]),i("p",{staticClass:"amount"},[t._v(t._s(t.$store.state.payCondition.card))])]),i("div",{staticClass:"detail"},[i("p",{staticClass:"title"},[t._v("支票")]),i("p",{staticClass:"amount"},[t._v(t._s(t.$store.state.payCondition.check))])]),i("div",{staticClass:"detail"},[i("p",{staticClass:"title"},[t._v("微信")]),i("p",{staticClass:"amount"},[t._v(t._s(t.$store.state.payCondition.wechat))])]),i("div",{staticClass:"detail"},[i("p",{staticClass:"title"},[t._v("阿里")]),i("p",{staticClass:"amount"},[t._v(t._s(t.$store.state.payCondition.alipay))])])])]),i("div",{staticClass:"handleArea"},[i("div",{staticClass:"handlePay"},[i("div",{staticClass:"payAmount"},[i("h3",[t._v("金额：")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.inputAmount,expression:"inputAmount"}],ref:"inputArea",staticStyle:{width:"90px",height:"40px","text-align":"left",border:"1px solid rgba(7, 17, 27, 0.1)"},attrs:{type:"number"},domProps:{value:t.inputAmount},on:{focus:function(e){return t.focus(e)},input:function(e){e.target.composing||(t.inputAmount=e.target.value)}}}),i("div",{staticClass:"totalPay"},[t._v("已付："+t._s(t.alreadyPay))]),i("div",{staticClass:"restPay"},[t._v("剩余："+t._s(t.restPay))])]),i("div",{staticClass:"payButton"},[i("v-btn",{on:{click:t.handlePayByVirement}},[t._v("转账")]),i("v-btn",{on:{click:t.handlePayByCash}},[t._v("现金")]),t._m(0),i("v-btn",{on:{click:t.handlePayByTicket}},[t._v("饭票")]),i("v-btn",{on:{click:t.handlePayByCard}},[t._v("刷卡")]),i("v-btn",{on:{click:t.handlePayByCheck}},[t._v("支票")]),i("v-btn",{on:{click:t.handlePayByWechat}},[t._v("微信")]),i("v-btn",{on:{click:t.handlePayByAlipay}},[t._v("阿里")])],1)])]),i("div",{ref:"orderWrapper",staticClass:"ordered_list"},[i("ul",t._l(t.$store.state.selectedDish,(function(e){return i("li",{key:e.order_id,staticClass:"order_container",on:{click:function(i){return t.handlePayingAdd(e)}}},[i("h3",{staticClass:"dish_name"},[t._v(t._s(Object.keys(e)[0]))]),i("p",{staticClass:"price"},[t._v(t._s(Object.values(e)[0].price))]),i("p",{staticClass:"quantity"},[t._v(t._s(Object.values(e)[0].quantity)+"份")]),i("p",{staticClass:"subTotal"},[t._v(t._s((Object.values(e)[0].price*Object.values(e)[0].quantity).toFixed(2)))])])})),0)]),i("div",{staticStyle:{position:"fixed",bottom:"20px",width:"100%"}},[i("v-btn",{staticClass:"submit",attrs:{rounded:""},on:{click:t.handleSubmit}},[t._v("提交后台")])],1)],1)},ft=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"history",staticStyle:{"grid-row":"1/6","grid-column":"3/4","background-color":"#eee","border-radius":"10px"}},[i("p",[t._v("付款记录")])])}],gt=(i("b680"),i("b85c")),mt=i("f40f"),yt=i("8336");i("bf40");function _t(t){function e(t){return i.apply(this,arguments)}function i(){return i=Object(Y["a"])(regeneratorRuntime.mark((function t(e){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,b()({url:"/testticketdetail/".concat(e.$route.params.table_num,"/")});case 2:i=t.sent,console.log(i.data),e.$store.commit("changePayCondition",i.data);case 5:case"end":return t.stop()}}),t)}))),i.apply(this,arguments)}e(t)}function kt(t,e,i){if(""!==i.inputAmount){var a=parseFloat(e)+parseFloat(i.inputAmount),n='{"'+t+'": '+a+"}";console.log(n),console.log(JSON.parse(n)),b()({url:"/testpatchticket/".concat(i.$store.state.tableId,"/"),method:"PATCH",data:JSON.parse(n)}).then((function(){_t(i)})),i.$refs.inputArea.select()}}var bt={components:{VBtn:yt["a"]},data:function(){return{payingList:[],payingDishShow:!1,inputAmount:""}},mounted:function(){var t=this;void 0!==this.$store.state.selectedDish.length&&this.$nextTick((function(){t._initScroll()}))},computed:{totalPrice:function(){var t=0;if(void 0!==this.$store.state.selectedDish.length){var e,i=Object(gt["a"])(this.$store.state.selectedDish);try{for(i.s();!(e=i.n()).done;){var a=e.value;t+=Object.values(a)[0].price*Object.values(a)[0].quantity}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0},tatalTax10:function(){var t=0;if(void 0!==this.$store.state.selectedDish.length){var e,i=Object(gt["a"])(this.$store.state.selectedDish);try{for(i.s();!(e=i.n()).done;){var a=e.value;"0.10"===Object.values(a)[0].tax&&(t+=(Object.values(a)[0].price-Object.values(a)[0].price/(1+parseFloat(Object.values(a)[0].tax)))*Object.values(a)[0].quantity)}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0},tatalTax20:function(){var t=0;if(void 0!==this.$store.state.selectedDish.length){var e,i=Object(gt["a"])(this.$store.state.selectedDish);try{for(i.s();!(e=i.n()).done;){var a=e.value;"0.20"===Object.values(a)[0].tax&&(t+=Object.values(a)[0].tax*Object.values(a)[0].quantity)}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0},tatalTax:function(){return(parseFloat(this.tatalTax10)+parseFloat(this.tatalTax20)).toFixed(2)},payingAmount:function(){var t=0;return this.payingList.forEach((function(e){t+=parseFloat(e.price)})),t.toFixed(2)},alreadyPay:function(){var t=0;return Object.values(this.$store.state.payCondition).forEach((function(e){t+=parseFloat(e)})),t},restPay:function(){var t=this.totalPrice-this.alreadyPay;return t.toFixed(2)}},methods:{focus:function(t){t.currentTarget.select()},handlePayClick:function(){this.payingList=[],this.$store.commit("changePayShow")},_initScroll:function(){this.orderScroll=new mt["a"](".ordered_list",{scrollY:!0,click:!0})},handlePayingAdd:function(t){var e=new Date,i={};a["a"].set(i,"id",e.getTime()),a["a"].set(i,"name",Object.keys(t)[0]),a["a"].set(i,"price",Object.values(t)[0].price),this.payingList.push(i),console.log(this.payingList)},handlePayingDel:function(t){console.log(this.payingList.indexOf(t));var e=this.payingList.indexOf(t);this.payingList.splice(e,1)},handlePayByVirement:function(){kt("pay_by_transfer",this.$store.state.payCondition.virement,this)},handlePayByCash:function(){kt("pay_by_cash",this.$store.state.payCondition.cash,this)},handlePayByTicket:function(){kt("pay_by_ticket",this.$store.state.payCondition.ticket,this)},handlePayByCard:function(){kt("pay_by_card",this.$store.state.payCondition.card,this)},handlePayByCheck:function(){kt("pay_by_check",this.$store.state.payCondition.check,this)},handlePayByWechat:function(){kt("pay_by_wechat",this.$store.state.payCondition.wechat,this)},handlePayByAlipay:function(){kt("pay_by_alipay",this.$store.state.payCondition.alipay,this)},handleSubmit:function(){var t=this;if(0===parseFloat(this.restPay)&&0!==parseFloat(this.totalPrice)){console.log("：：：：：：：：开始进入提交程序");var e=new Date,i={};i.finish_time=e.getFullYear().toString()+((e.getMonth()+1).toString().length<2?"0"+(e.getMonth()+1).toString():(e.getMonth()+1).toString())+e.getDate().toString()+(e.getHours().toString().length<2?"0"+e.getHours().toString():e.getHours().toString())+(e.getMinutes().toString().length<2?"0"+e.getMinutes().toString():e.getMinutes().toString())+(e.getSeconds().toString().length<2?"0"+e.getSeconds().toString():e.getSeconds().toString()),i.payment_status=2,i.ticket_status=2,i.ticket_price=this.totalPrice,i.ticket_tax10=this.tatalTax10,i.ticket_tax20=this.tatalTax20,i.ticket_tax=this.tatalTax,console.log(i),b()({url:"/testpatchticket/".concat(this.$store.state.tableId,"/"),method:"PATCH",data:i}).then((function(){t.$router.push("/salle")})).catch((function(t){return console.log(t)}))}else console.log("没有开始提交")}},beforeDestroy:function(){this.payingList=[]},watch:{"$store.state.payShow":function(){var t=this;this.$nextTick((function(){t.$store.state.payShow&&(t.orderScroll?(t.orderScroll.refresh(),console.log("刷新了Bs")):t._initScroll())}))}}},wt=bt,xt=(i("1703"),i("6544")),Ct=i.n(xt),St=Object(r["a"])(wt,vt,ft,!1,null,"9f91845a",null),Tt=St.exports;function Dt(){console.length("order页面发生滚动")}Ct()(St,{VBtn:yt["a"]});var $t={components:{Category:R,Dish:J,Info:L,Navbar:at,Ticket:pt,Pay:Tt},data:function(){return{categories:[]}},methods:{handleClick:function(){console.log("changingOrderDetail:::::::",this.$store.state.table.changingOrderDetail[0].checked)}},mounted:function(){var t=this;window.addEventListener("scroll",Dt),this.$store.commit("hide",!1),b()({url:"/testticket/"+this.$route.params.table_num+"/"}).then((function(e){console.log("人数",e.data[0].ticket_personquantity),t.$store.commit("changeTableNum",{table_num:t.$route.params.table_num,orderlength:e.data.length,person_quantity:parseInt(e.data[0].ticket_personquantity)})})).catch((function(e){console.log("由于ticket内没有order，方法1获取失败",e),console.log("测试下是否执行了这句话"),b()({url:"/testticketdetail/".concat(t.$route.params.table_num,"/")}).then((function(e){console.log(e.data[0]),t.$store.commit("changeTableNum",{table_num:t.$route.params.table_num,orderlength:e.data.length,person_quantity:parseInt(e.data[0].person_quantity)})})).catch((function(e){console.log("由于ticket内没有order，方法2获取失败",e),t.$store.commit("changeTableNum",{table_num:t.$route.params.table_num,orderlength:0,person_quantity:0})}))}))},beforeDestroy:function(){this.$store.commit("show"),this.$store.commit("hideTicketShow"),this.$store.commit("hidePayShow")},watch:{"$store.state.ticketShow":function(){!0===this.$store.state.ticketShow&&console.log("禁止滑动")}}},Ot=$t,Pt=(i("ad60"),Object(r["a"])(Ot,T,D,!1,null,"c0278f16",null)),Nt=Pt.exports,jt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"outer2"},[i("div",{staticClass:"nav"},[i("div",{staticClass:"category",class:[3===t.activeTab?"active":""],on:{click:function(e){t.activeTab=3}}},[i("p",[t._v("全部")])]),i("div",{staticClass:"category",class:[0===t.activeTab?"active":""],on:{click:function(e){t.activeTab=0}}},[i("p",[t._v("堂食")])]),i("div",{staticClass:"category",class:[1===t.activeTab?"active":""],on:{click:function(e){t.activeTab=1}}},[i("p",[t._v("打包")])]),i("div",{staticClass:"category",class:[2===t.activeTab?"active":""],on:{click:function(e){t.activeTab=2}}},[i("p",[t._v("外送")])])]),t._m(0),i("Summary",{attrs:{ticketList:t.ticketList}}),i("ticket-list",{attrs:{ticketList:t.ticketList},on:{handleDetailShow:t.onHandleDetailShow}}),i("transition",{attrs:{name:"slide2"}},[i("detail",{directives:[{name:"show",rawName:"v-show",value:t.detailShow,expression:"detailShow"}],attrs:{detailShow:t.detailShow,ticketId:t.ticketId},on:{hidedetail:t.onHideDetail}})],1)],1)},Lt=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"searchBar"},[i("i",{staticClass:"iconfont icon-fangdajing"}),i("div",{staticStyle:{height:"90%","border-right":"1px solid rgba(7, 17, 27, 0.1)"}},[i("input",{staticStyle:{width:"100%",height:"100%","text-align":"left",color:"rgb(7, 17, 27)"},attrs:{type:"text",placeholder:"搜索内容"}})]),i("div",[t._v(" 过滤 "),i("i",{staticClass:"iconfont icon-arrow-right"})])])}],At=(i("4de4"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"outer2"},[i("div",{staticClass:"header"},[i("i",{staticClass:"iconfont icon-zuojiantou",staticStyle:{"text-align":"right","margin-left":"0px",border:"2px solid white","border-radius":"50%","font-size":"2em",color:"black","font-weight":"bolder"},on:{click:t.handleShow}}),i("p",[t._v("桌号："+t._s(t.ticketDetail.table_num))])]),i("div",{staticClass:"stickyArea"},[i("div",{attrs:{id:"total"}},[i("div",{attrs:{id:"tax10"}},[i("p",{staticClass:"taxTitle"},[t._v("10%")]),i("p",[t._v(t._s(t.tatalTax10))])]),i("div",{attrs:{id:"tax20"}},[i("p",{staticClass:"taxTitle"},[t._v("20%")]),t._v(" "+t._s(t.tatalTax20)+" ")]),i("div",{attrs:{id:"totalTax"}},[i("p",{staticClass:"taxTitle"},[t._v("总TVA")]),t._v(" "+t._s(t.tatalTax))]),i("h2",{attrs:{id:"totalPrice"}},[t._v("总："+t._s(t.ticketDetail.ticket_price))])]),i("div",{staticClass:"detailArea"},[i("div",{staticClass:"detail",staticStyle:{color:"#2CA4B0"}},[i("p",{staticClass:"title"},[t._v("转账")]),i("p",{staticClass:"amount"},[t._v(t._s(t.ticketDetail.pay_by_transfer))])]),i("div",{staticClass:"detail",staticStyle:{color:"#ff4a4a"}},[i("p",{staticClass:"title"},[t._v("现金")]),i("p",{staticClass:"amount"},[t._v(t._s(t.ticketDetail.pay_by_cash))])]),i("div",{staticClass:"detail",staticStyle:{color:"#217969"}},[i("p",{staticClass:"title"},[t._v("饭票")]),i("p",{staticClass:"amount"},[t._v(t._s(t.ticketDetail.pay_by_ticket))])]),i("div",{staticClass:"detail",staticStyle:{color:"#b48608"}},[i("p",{staticClass:"title"},[t._v("刷卡")]),i("p",{staticClass:"amount"},[t._v(t._s(t.ticketDetail.pay_by_card))])]),i("div",{staticClass:"detail"},[i("p",{staticClass:"title"},[t._v("支票")]),i("p",{staticClass:"amount"},[t._v(t._s(t.ticketDetail.pay_by_check))])]),i("div",{staticClass:"detail"},[i("p",{staticClass:"title"},[t._v("微信")]),i("p",{staticClass:"amount"},[t._v(t._s(t.ticketDetail.pay_by_wechat))])]),i("div",{staticClass:"detail"},[i("p",{staticClass:"title"},[t._v("阿里")]),i("p",{staticClass:"amount"},[t._v(t._s(t.ticketDetail.pay_by_alipay))])])])]),i("div",{staticClass:"handleArea"},[i("div",{staticClass:"handlePay"},[i("div",{staticClass:"payAmount"},[i("h3",[t._v("金额：")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.inputAmount,expression:"inputAmount"}],ref:"inputArea",staticStyle:{width:"90px",height:"40px","text-align":"left",border:"1px solid rgba(7, 17, 27, 0.1)"},attrs:{type:"number"},domProps:{value:t.inputAmount},on:{focus:function(e){return t.focus(e)},input:function(e){e.target.composing||(t.inputAmount=e.target.value)}}}),i("div",{staticClass:"totalPay"},[t._v("已付："+t._s(t.alreadyPay))]),i("div",{staticClass:"restPay"},[t._v("剩余："+t._s(t.restPay))])]),i("div",{staticClass:"payButton"},[i("v-btn",{on:{click:t.handlePayByVirement}},[t._v("转账")]),i("v-btn",{on:{click:t.handlePayByCash}},[t._v("现金")]),t._m(0),i("v-btn",{on:{click:t.handlePayByTicket}},[t._v("饭票")]),i("v-btn",{on:{click:t.handlePayByCard}},[t._v("刷卡")]),i("v-btn",{on:{click:t.handlePayByCheck}},[t._v("支票")]),i("v-btn",{on:{click:t.handlePayByWechat}},[t._v("微信")]),i("v-btn",{on:{click:t.handlePayByAlipay}},[t._v("阿里")])],1)])]),i("div",{ref:"orderWrapper",staticClass:"ordered_list"},[i("ul",t._l(t.selectedDish,(function(e){return i("li",{key:e.order_id,staticClass:"order_container"},[i("h3",{staticClass:"dish_name"},[t._v(t._s(Object.keys(e)[0]))]),i("p",{staticClass:"price"},[t._v(t._s(Object.values(e)[0].price))]),i("p",{staticClass:"quantity"},[t._v(t._s(Object.values(e)[0].quantity)+"份")]),i("p",{staticClass:"subTotal"},[t._v(t._s((Object.values(e)[0].price*Object.values(e)[0].quantity).toFixed(2)))])])})),0)]),i("div",{staticClass:"buttonArea"},[i("v-btn",{attrs:{dark:"",rounded:"",color:"#217969",width:"80%"},on:{click:t.handleSubmit}},[i("span",[t._v("提交")])]),i("v-btn",{attrs:{dark:"",rounded:"",color:"#ff4a4a",width:"80%"},on:{click:t.backToFront}},[t._v("退回前台")]),i("v-btn",{attrs:{dark:"",rounded:"",color:"#ff4a4a",width:"80%"},on:{click:t.showPopup}},[t._v("删除")])],1),i("van-popup",{staticClass:"confirmArea",style:{height:"30%",width:"100%"},attrs:{id:"delete_submit",round:"",position:"bottom"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[i("v-btn",{attrs:{dark:"",rounded:"",color:"#ff4a4a",width:"50%"},on:{click:t.handleDelete}},[t._v("删除")]),i("v-btn",{attrs:{rounded:"",width:"50%"},on:{click:function(e){t.show=!1}}},[t._v("取消")])],1)],1)}),Ft=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"history",staticStyle:{"grid-row":"1/6","grid-column":"3/4","background-color":"#eee","border-radius":"10px"}},[i("p",[t._v("付款记录")])])}];a["a"].use(ot["a"]);var Bt={props:["detailShow","ticketId"],components:{VBtn:yt["a"]},data:function(){return{inputAmount:"",ticketDetail:{},selectedDish:[],payCondition:{},show:!1}},mounted:function(){},computed:{totalPrice:function(){var t=0;if(void 0!==this.selectedDish.length){var e,i=Object(gt["a"])(this.selectedDish);try{for(i.s();!(e=i.n()).done;){var a=e.value;t+=Object.values(a)[0].price*Object.values(a)[0].quantity}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0},tatalTax10:function(){var t=0;if(void 0!==this.selectedDish.length){var e,i=Object(gt["a"])(this.selectedDish);try{for(i.s();!(e=i.n()).done;){var a=e.value;"0.10"===Object.values(a)[0].tax&&(t+=(Object.values(a)[0].price-Object.values(a)[0].price/(1+parseFloat(Object.values(a)[0].tax)))*Object.values(a)[0].quantity)}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0},tatalTax20:function(){var t=0;if(void 0!==this.selectedDish.length){var e,i=Object(gt["a"])(this.selectedDish);try{for(i.s();!(e=i.n()).done;){var a=e.value;"0.20"===Object.values(a)[0].tax&&(t+=Object.values(a)[0].tax*Object.values(a)[0].quantity)}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0},tatalTax:function(){return(parseFloat(this.tatalTax10)+parseFloat(this.tatalTax20)).toFixed(2)},alreadyPay:function(){var t=this,e=0;return Object.keys(this.ticketDetail).forEach((function(i){i.includes("pay_by")&&(e+=parseFloat(t.ticketDetail[i]))})),e},restPay:function(){var t=this.totalPrice-this.alreadyPay;return t.toFixed(2)}},methods:{handleShow:function(){this.orderScroll=null,this.$emit("hidedetail")},focus:function(t){t.currentTarget.select()},handlePayClick:function(){this.payingList=[],this.$store.commit("changePayShow")},_initScroll:function(){this.orderScroll=new mt["a"](".ordered_list",{scrollY:!0,click:!0})},handlePayByVirement:function(){""!==this.inputAmount&&this.inputAmount>=0&&a["a"].set(this.ticketDetail,"pay_by_transfer",parseFloat(this.inputAmount).toFixed(2))},handlePayByCash:function(){""!==this.inputAmount&&this.inputAmount>=0&&a["a"].set(this.ticketDetail,"pay_by_cash",parseFloat(this.inputAmount).toFixed(2))},handlePayByTicket:function(){""!==this.inputAmount&&this.inputAmount>=0&&a["a"].set(this.ticketDetail,"pay_by_ticket",parseFloat(this.inputAmount).toFixed(2))},handlePayByCard:function(){""!==this.inputAmount&&this.inputAmount>=0&&a["a"].set(this.ticketDetail,"pay_by_card",parseFloat(this.inputAmount).toFixed(2))},handlePayByCheck:function(){""!==this.inputAmount&&this.inputAmount>=0&&a["a"].set(this.ticketDetail,"pay_by_check",parseFloat(this.inputAmount).toFixed(2))},handlePayByWechat:function(){""!==this.inputAmount&&this.inputAmount>=0&&a["a"].set(this.ticketDetail,"pay_by_wechat",parseFloat(this.inputAmount).toFixed(2))},handlePayByAlipay:function(){""!==this.inputAmount&&this.inputAmount>=0&&a["a"].set(this.ticketDetail,"pay_by_alipay",parseFloat(this.inputAmount).toFixed(2))},handleSubmit:function(){"0.00"===this.restPay?b()({url:"/testticketdetailpaied/".concat(this.ticketId,"/"),method:"PATCH",data:this.ticketDetail}).then((function(t){alert("修改成功")})).catch((function(t){return console.log(t)})):alert("剩余".concat(this.restPay,"未结清"))},showPopup:function(){this.show=!0},backToFront:function(){var t=this;b()({url:"/testticketdetailpaied/".concat(this.ticketId,"/"),method:"PATCH",data:{payment_status:0}}).then((function(e){t.$router.go(0)})).catch((function(t){return console.log(t)}))},handleDelete:function(){var t=this;b()({url:"/testticketdetailpaied/".concat(this.ticketId,"/"),method:"DELETE"}).then((function(e){t.$router.go(0)})).catch((function(t){return console.log(t)}))}},watch:{detailShow:function(){var t=this;b()({url:"/testticketdetailpaied/".concat(this.ticketId,"/")}).then((function(e){t.ticketDetail=e.data})).catch((function(t){return console.log(t)})),b()({url:"/testticketordergroupby2/".concat(this.ticketId,"/")}).then((function(e){console.log(e.data),t.selectedDish=e.data.map((function(t){var e={};return e[t.dname]={quantity:t.total_quantity[0],price:t.dprice,tax:t.dtax},e})),t.$nextTick((function(){t.detailShow&&(t.orderScroll?t.orderScroll.refresh():t._initScroll())}))})).catch((function(t){return console.log(t)}))}}},Et=Bt,It=(i("b5ac"),Object(r["a"])(Et,At,Ft,!1,null,"28bc5181",null)),Rt=It.exports;Ct()(It,{VBtn:yt["a"]});var Ht=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"ticketList"},[i("ul",t._l(t.ticketList,(function(e){return i("li",{key:e.ticket_id,on:{click:function(i){return t.handleDetailShow(e)}}},[i("div",{staticClass:"type"},[i("h3",[t._v(t._s(t.type(e)))])]),i("div",{staticClass:"detail"},[i("h3",{staticClass:"name"},[t._v(t._s(t.title(e)))]),i("p",{staticClass:"amount"},[t._v("总价："+t._s(e.ticket_price))]),2!==e.type?i("div",{staticClass:"pay"},[i("div",{directives:[{name:"show",rawName:"v-show",value:"0.00"!=e.pay_by_transfer,expression:"data.pay_by_transfer != '0.00'"}],staticClass:"payDetail",staticStyle:{color:"#2CA4B0"}},[i("p",{staticClass:"title"},[t._v("转账")]),i("p",{staticClass:"amount"},[t._v(t._s(e.pay_by_transfer))])]),i("div",{directives:[{name:"show",rawName:"v-show",value:"0.00"!=e.pay_by_cash,expression:"data.pay_by_cash != '0.00'"}],staticClass:"payDetail",staticStyle:{color:"#ff4a4a"}},[i("p",{staticClass:"title"},[t._v("现金")]),i("p",{staticClass:"amount"},[t._v(t._s(e.pay_by_cash))])]),i("div",{directives:[{name:"show",rawName:"v-show",value:"0.00"!=e.pay_by_ticket,expression:"data.pay_by_ticket != '0.00'"}],staticClass:"payDetail",staticStyle:{color:"#217969"}},[i("p",{staticClass:"title"},[t._v("饭票")]),i("p",{staticClass:"amount"},[t._v(t._s(e.pay_by_ticket))])]),i("div",{directives:[{name:"show",rawName:"v-show",value:"0.00"!=e.pay_by_card,expression:"data.pay_by_card != '0.00'"}],staticClass:"payDetail",staticStyle:{color:"#b48608"}},[i("p",{staticClass:"title"},[t._v("刷卡")]),i("p",{staticClass:"amount"},[t._v(t._s(e.pay_by_card))])]),i("div",{directives:[{name:"show",rawName:"v-show",value:"0.00"!=e.pay_by_check,expression:"data.pay_by_check != '0.00'"}],staticClass:"payDetail"},[i("p",{staticClass:"title"},[t._v("支票")]),i("p",{staticClass:"amount"},[t._v(t._s(e.pay_by_check))])]),i("div",{directives:[{name:"show",rawName:"v-show",value:"0.00"!=e.pay_by_wechat,expression:"data.pay_by_wechat != '0.00'"}],staticClass:"payDetail"},[i("p",{staticClass:"title"},[t._v("微信")]),i("p",{staticClass:"amount"},[t._v(t._s(e.pay_by_wechat))])]),i("div",{directives:[{name:"show",rawName:"v-show",value:"0.00"!=e.pay_by_alipay,expression:"data.pay_by_alipay != '0.00'"}],staticClass:"payDetail"},[i("p",{staticClass:"title"},[t._v("阿里")]),i("p",{staticClass:"amount"},[t._v(t._s(e.pay_by_alipay))])])]):2===e.type?i("div",{staticClass:"address"},[t._v(" "+t._s(e.client_address)+" ")]):t._e()]),t._m(0,!0)])})),0)])},qt=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"arrow"},[i("i",{staticClass:"iconfont icon-arrow-right"})])}],Mt={props:["ticketList"],data:function(){return{platformOption:[{text:"Ricepo",value:1},{text:"HungryP",value:2},{text:"Uber",value:3},{text:"JustEat",value:4},{text:"小程序",value:5},{text:"微信",value:6},{text:"官网",value:7},{text:"微米",value:8},{text:"方圆",value:9},{text:"呱呱",value:10},{text:"Deliveroo",value:11},{text:"无",value:12}]}},computed:{type:function(){return function(t){return 0===t.type?"堂食":1===t.type?"打包":"外送"}},platform:function(){return function(t){switch(t.delivery_platform){case 1:return" - Ricepo";case 2:return" - HungryPanda";case 3:return" - Uber";case 4:return" - JustEat";case 5:return" - 小程序";case 6:return" - 微信";case 7:return" - 官网";case 8:return" - 微米";case 9:return" - 方圆食里";case 10:return" - 呱呱到家";case 11:return" - Deliveroo";case 12:return"";default:return""}}},deliveryMan:function(){return function(t){switch(t.delivery_man){case 1:return"";case 2:return" - 张俊";case 3:return" - 阿然";case 4:return" - 老马";default:return""}}},title:function(){return function(t){return 0===t.type?"桌号："+t.table_num:1===t.type?"打包":"编号："+t.table_num+this.platform(t)+this.deliveryMan(t)}}},methods:{handleDetailShow:function(t){this.$emit("handleDetailShow",t)}}},zt=Mt,Wt=(i("2abe"),Object(r["a"])(zt,Ht,qt,!1,null,"3d1539be",null)),Ut=Wt.exports,Jt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"stickyArea"},[i("div",{attrs:{id:"total"}},[i("div",{attrs:{id:"tax10"}},[i("p",{staticClass:"taxTitle"},[t._v("10%")]),i("p",[t._v(t._s(t.tatalTax10))])]),i("div",{attrs:{id:"tax20"}},[i("p",{staticClass:"taxTitle"},[t._v("20%")]),t._v(" "+t._s(t.tatalTax20)+" ")]),i("div",{attrs:{id:"totalTax"}},[i("p",{staticClass:"taxTitle"},[t._v("总TVA")]),t._v(" "+t._s(t.tatalTax))]),i("h2",{attrs:{id:"totalPrice"}},[t._v("总："+t._s(t.totalPrice))])]),i("div",{staticClass:"detailArea"},[i("div",{staticClass:"detail",staticStyle:{color:"#2CA4B0"}},[i("p",{staticClass:"title"},[t._v("转账")]),i("p",{staticClass:"amount"},[t._v(t._s(t.totalVirement))])]),i("div",{staticClass:"detail",staticStyle:{color:"#ff4a4a"}},[i("p",{staticClass:"title"},[t._v("现金")]),i("p",{staticClass:"amount"},[t._v(t._s(t.totalCash))])]),i("div",{staticClass:"detail",staticStyle:{color:"#217969"}},[i("p",{staticClass:"title"},[t._v("饭票")]),i("p",{staticClass:"amount"},[t._v(t._s(t.totalTicket))]),i("p",{staticStyle:{"font-size":"10px","margin-top":"-5px"}},[t._v("("+t._s(t.totalTicketCount)+"张)")])]),i("div",{staticClass:"detail",staticStyle:{color:"#b48608"}},[i("p",{staticClass:"title"},[t._v("刷卡")]),i("p",{staticClass:"amount"},[t._v(t._s(t.totalCard))])]),i("div",{staticClass:"detail"},[i("p",{staticClass:"title"},[t._v("支票")]),i("p",{staticClass:"amount"},[t._v(t._s(t.totalCheck))])]),i("div",{staticClass:"detail"},[i("p",{staticClass:"title"},[t._v("微信")]),i("p",{staticClass:"amount"},[t._v(t._s(t.totalWechat))])]),i("div",{staticClass:"detail"},[i("p",{staticClass:"title"},[t._v("阿里")]),i("p",{staticClass:"amount"},[t._v(t._s(t.totalAlipay))])])])])},Vt=[],Qt={props:["ticketList"],computed:{totalPrice:function(){var t=0;if(void 0!==this.ticketList.length){var e,i=Object(gt["a"])(this.ticketList);try{for(i.s();!(e=i.n()).done;){var a=e.value;t+=parseFloat(a.ticket_price)}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0},tatalTax10:function(){var t=0;if(void 0!==this.ticketList.length){var e,i=Object(gt["a"])(this.ticketList);try{for(i.s();!(e=i.n()).done;){var a=e.value;t+=parseFloat(a.ticket_tax10)}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0},tatalTax20:function(){var t=0;if(void 0!==this.ticketList.length){var e,i=Object(gt["a"])(this.ticketList);try{for(i.s();!(e=i.n()).done;){var a=e.value;t+=parseFloat(a.ticket_tax20)}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0},tatalTax:function(){return(parseFloat(this.tatalTax10)+parseFloat(this.tatalTax20)).toFixed(2)},totalVirement:function(){var t=0;if(void 0!==this.ticketList.length){var e,i=Object(gt["a"])(this.ticketList);try{for(i.s();!(e=i.n()).done;){var a=e.value;t+=parseFloat(a.pay_by_transfer)}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0},totalCash:function(){var t=0;if(void 0!==this.ticketList.length){var e,i=Object(gt["a"])(this.ticketList);try{for(i.s();!(e=i.n()).done;){var a=e.value;t+=parseFloat(a.pay_by_cash)}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0},totalTicket:function(){var t=0;if(void 0!==this.ticketList.length){var e,i=Object(gt["a"])(this.ticketList);try{for(i.s();!(e=i.n()).done;){var a=e.value;t+=parseFloat(a.pay_by_ticket)}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0},totalTicketCount:function(){var t=0;if(void 0!==this.ticketList.length){var e,i=Object(gt["a"])(this.ticketList);try{for(i.s();!(e=i.n()).done;){var a=e.value;t+=a.ticket_restaurant_count}}catch(n){i.e(n)}finally{i.f()}return t}return 0},totalCard:function(){var t=0;if(void 0!==this.ticketList.length){var e,i=Object(gt["a"])(this.ticketList);try{for(i.s();!(e=i.n()).done;){var a=e.value;t+=parseFloat(a.pay_by_card)}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0},totalCheck:function(){var t=0;if(void 0!==this.ticketList.length){var e,i=Object(gt["a"])(this.ticketList);try{for(i.s();!(e=i.n()).done;){var a=e.value;t+=parseFloat(a.pay_by_check)}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0},totalWechat:function(){var t=0;if(void 0!==this.ticketList.length){var e,i=Object(gt["a"])(this.ticketList);try{for(i.s();!(e=i.n()).done;){var a=e.value;t+=parseFloat(a.pay_by_wechat)}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0},totalAlipay:function(){var t=0;if(void 0!==this.ticketList.length){var e,i=Object(gt["a"])(this.ticketList);try{for(i.s();!(e=i.n()).done;){var a=e.value;t+=parseFloat(a.pay_by_alipay)}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0}}},Yt=Qt,Gt=(i("5c2e"),Object(r["a"])(Yt,Jt,Vt,!1,null,"25fae47b",null)),Zt=Gt.exports;function Kt(t){return Xt.apply(this,arguments)}function Xt(){return Xt=Object(Y["a"])(regeneratorRuntime.mark((function t(e){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,b()({url:"/testticketlistpaied/"});case 2:i=t.sent,e.ticketList=Object.values(i.data),console.log(e.ticketList),e.$nextTick((function(){e.orderScroll?e.orderScroll.refresh():e._initScroll()}));case 6:case"end":return t.stop()}}),t)}))),Xt.apply(this,arguments)}var te={components:{Detail:Rt,TicketList:Ut,Summary:Zt},data:function(){return{activeTab:3,ticketList:[],ticketDetail:{},selectedDish2:[],detailShow:!1,ticketId:""}},mounted:function(){Kt(this)},computed:{type:function(){return function(t){return 0===t.type?"堂食":1===t.type?"打包":"外送"}},title:function(){return function(t){return 0===t.type?"桌号："+t.table_num:1===t.type?"打包":"外送"}},totalPrice:function(){var t=0;if(void 0!==this.ticketList.length){var e,i=Object(gt["a"])(this.ticketList);try{for(i.s();!(e=i.n()).done;){var a=e.value;t+=parseFloat(a.ticket_price)}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0},tatalTax10:function(){var t=0;if(void 0!==this.ticketList.length){var e,i=Object(gt["a"])(this.ticketList);try{for(i.s();!(e=i.n()).done;){var a=e.value;t+=parseFloat(a.ticket_tax10)}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0},tatalTax20:function(){var t=0;if(void 0!==this.ticketList.length){var e,i=Object(gt["a"])(this.ticketList);try{for(i.s();!(e=i.n()).done;){var a=e.value;t+=parseFloat(a.ticket_tax20)}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0},tatalTax:function(){return(parseFloat(this.tatalTax10)+parseFloat(this.tatalTax20)).toFixed(2)},totalVirement:function(){var t=0;if(void 0!==this.ticketList.length){var e,i=Object(gt["a"])(this.ticketList);try{for(i.s();!(e=i.n()).done;){var a=e.value;t+=parseFloat(a.pay_by_transfer)}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0},totalCash:function(){var t=0;if(void 0!==this.ticketList.length){var e,i=Object(gt["a"])(this.ticketList);try{for(i.s();!(e=i.n()).done;){var a=e.value;t+=parseFloat(a.pay_by_cash)}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0},totalTicket:function(){var t=0;if(void 0!==this.ticketList.length){var e,i=Object(gt["a"])(this.ticketList);try{for(i.s();!(e=i.n()).done;){var a=e.value;t+=parseFloat(a.pay_by_ticket)}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0},totalCard:function(){var t=0;if(void 0!==this.ticketList.length){var e,i=Object(gt["a"])(this.ticketList);try{for(i.s();!(e=i.n()).done;){var a=e.value;t+=parseFloat(a.pay_by_card)}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0},totalCheck:function(){var t=0;if(void 0!==this.ticketList.length){var e,i=Object(gt["a"])(this.ticketList);try{for(i.s();!(e=i.n()).done;){var a=e.value;t+=parseFloat(a.pay_by_check)}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0},totalWechat:function(){var t=0;if(void 0!==this.ticketList.length){var e,i=Object(gt["a"])(this.ticketList);try{for(i.s();!(e=i.n()).done;){var a=e.value;t+=parseFloat(a.pay_by_wechat)}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0},totalAlipay:function(){var t=0;if(void 0!==this.ticketList.length){var e,i=Object(gt["a"])(this.ticketList);try{for(i.s();!(e=i.n()).done;){var a=e.value;t+=parseFloat(a.pay_by_alipay)}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0}},methods:{onHandleDetailShow:function(t){this.ticketId=t.ticket_id,this.detailShow=!this.detailShow},onHideDetail:function(t){Kt(this),this.detailShow=!1},_initScroll:function(){this.orderScroll=new mt["a"](".ticketList",{scrollY:!0,click:!0})},getTicket:function(){var t=this;return Object(Y["a"])(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,b()({url:"/testticketlistpaied/"});case 2:i=e.sent,3===t.activeTab?t.ticketList=Object.values(i.data):t.ticketList=Object.values(i.data).filter((function(e){return e.type===t.activeTab})),t.$nextTick((function(){t.orderScroll?t.orderScroll.refresh():t._initScroll()}));case 5:case"end":return e.stop()}}),e)})))()}},watch:{activeTab:function(){switch(this.activeTab){case 0:console.log("tab===2"),this.getTicket();break;case 1:console.log("tab===1"),this.getTicket();break;case 2:console.log("tab===2"),this.getTicket();break;case 3:console.log("tab===3"),this.getTicket();break;default:this.ticketList=this.ticketList.filter((function(t){return 2===t.type}));break}}}},ee=te,ie=(i("24e3"),Object(r["a"])(ee,jt,Lt,!1,null,"7987c288",null)),ae=ie.exports,ne=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"outer2"},[i("div",{staticClass:"nav"},[i("div",{staticClass:"category",class:[3===t.activeTab?"active":""],on:{click:function(e){t.activeTab=3}}},[i("p",[t._v("全部")])]),i("div",{staticClass:"category",class:[0===t.activeTab?"active":""],on:{click:function(e){t.activeTab=0}}},[i("p",[t._v("堂食")])]),i("div",{staticClass:"category",class:[1===t.activeTab?"active":""],on:{click:function(e){t.activeTab=1}}},[i("p",[t._v("打包")])]),i("div",{staticClass:"category",class:[2===t.activeTab?"active":""],on:{click:function(e){t.activeTab=2}}},[i("p",[t._v("外送")])])]),t._m(0),i("Summary",{attrs:{ticketList:t.ticketList}}),i("ticket-list",{attrs:{ticketList:t.ticketList},on:{handleDetailShow:t.onHandleDetailShow}}),i("v-speed-dial",{staticClass:"newTicket",attrs:{transition:"slide-y-reverse-transition",color:"primary"},scopedSlots:t._u([{key:"activator",fn:function(){return[i("v-btn",{attrs:{color:"#217969",dark:"",fab:""},model:{value:t.fab,callback:function(e){t.fab=e},expression:"fab"}},[t.fab?i("v-icon",[t._v(" mdi-close ")]):i("v-icon",[t._v(" mdi-plus ")])],1)]},proxy:!0}]),model:{value:t.fab,callback:function(e){t.fab=e},expression:"fab"}},[i("v-btn",{attrs:{fab:"",dark:"",small:"",color:"#4CAF50"},on:{click:function(e){t.wechatShow=!t.wechatShow}}},[i("v-icon",[t._v("mdi-wechat")])],1),i("v-btn",{attrs:{fab:"",dark:"",small:"",color:"#3F51B5"},on:{click:t.handleNewTicket}},[i("i",{staticClass:"iconfont icon-qishou"})]),i("v-btn",{attrs:{fab:"",dark:"",small:"",color:"#7986CB"},on:{click:t.handleNewEmporterTicket}},[i("i",{staticClass:"iconfont icon-waidai",staticStyle:{fontsize:"20px"}})]),i("v-btn",{attrs:{fab:"",dark:"",small:"",color:"#F44336"},on:{click:t.getAllDishGroupBy}},[i("v-icon",[t._v("mdi-function-variant")])],1),i("v-btn",{attrs:{fab:"",dark:"",small:"",color:""},on:{click:t.handleArrangementShow}},[i("v-icon",[t._v("mdi-account-details")])],1)],1),i("transition",{attrs:{name:"testslide"}},[i("delivery-detail",{directives:[{name:"show",rawName:"v-show",value:t.detailShow,expression:"detailShow"}],ref:"deliverydetail",attrs:{detailShow:t.detailShow,ticket_id:t.ticketId,wechatTicket:t.wechatTicket},on:{hidedetail:t.onHideDetail}})],1),i("transition",{attrs:{name:"testslide"}},[i("wechat-list",{directives:[{name:"show",rawName:"v-show",value:t.wechatShow,expression:"wechatShow"}],ref:"wechatlist",on:{hideWechat:t.onHideWechat,createNewWechatTicket:t.onCreateNewWechatTicket}})],1),i("transition",{attrs:{name:"testslide"}},[i("dish-groupby",{directives:[{name:"show",rawName:"v-show",value:t.groupbyShow,expression:"groupbyShow"}],ref:"groupbylist",attrs:{groupbyList:t.groupbyList},on:{hideGroupby:t.onHideGroupby,createNewWechatTicket:t.onCreateNewWechatTicket}})],1)],1)},se=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"searchBar"},[i("i",{staticClass:"iconfont icon-fangdajing"}),i("div",{staticStyle:{height:"90%","border-right":"1px solid rgba(7, 17, 27, 0.1)"}},[i("input",{staticStyle:{width:"100%",height:"100%","text-align":"left",color:"rgb(7, 17, 27)"},attrs:{type:"text",placeholder:"搜索内容"}})]),i("div",[t._v(" 过滤 "),i("i",{staticClass:"iconfont icon-arrow-right"})])])}],oe=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"outer2"},[i("top-nav",{attrs:{ticketBasicDetail:t.ticketBasicDetail},on:{hideDetail:t.onHideDetail,patchTicketBasicDetailQuickly:t.onPatchTicketBasicDetailQuickly,patchTicketBasicDetail:t.onPatchTicketBasicDetail}}),i("order-area",{ref:"orderarea",attrs:{ticket_id:t.ticket_id,wechatTicket:t.wechatTicket}}),i("bottom-nav",{ref:"bottomnav",attrs:{ticketDetail:t.ticketBasicDetail},on:{submit:t.onSubmit,handelTicketShow:t.onTicketShow,handelPayShow:t.onPayShow}}),i("transition",{attrs:{name:"ticket"}},[i("ticket",{directives:[{name:"show",rawName:"v-show",value:t.ticketShow,expression:"ticketShow"}],ref:"ticket",attrs:{ticket_id:t.ticket_id,ticketBasicDetail:t.ticketBasicDetail,ticketOrder:t.ticketOrder},on:{handelTicketShow:t.onTicketShow,hideDetail2:t.onHideDetail2}})],1),i("transition",{attrs:{name:"ticket"}},[i("pay",{directives:[{name:"show",rawName:"v-show",value:t.payShow,expression:"payShow"}],attrs:{ticketId:t.ticket_id,payShow:t.payShow},on:{hidedetail:t.onHidePay}})],1)],1)},ce=[],re=(i("a9e3"),i("ac1f"),i("1276"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"topnav",class:t.showMore?"long":""},[i("div",{staticClass:"home_page"},[i("i",{staticClass:"iconfont icon-zuojiantou",on:{click:t.handleHideDetail}})]),i("div",{staticClass:"table_num",staticStyle:{"font-size":"12px"}},[i("i",{staticClass:"iconfont icon-bianhao"}),i("span",{attrs:{id:"input_table_num"}},[t._v(t._s(t.ticketBasicDetail.table_num))])]),i("div",{staticClass:"platform",staticStyle:{"font-size":"12px"}},[i("i",{staticClass:"iconfont icon-pingtai"}),i("span",[t._v(t._s(t.platform))])]),i("div",{staticClass:"name",staticStyle:{"font-size":"12px"}},[i("i",{staticClass:"iconfont icon-kb-persion"}),i("span",[t._v(t._s(t.ticketBasicDetail.client_name))])]),i("div",{staticClass:"time"},[i("i",{staticClass:"iconfont icon-shijian"}),i("span",[t._v(t._s(t.ticketBasicDetail.delivery_time))])]),i("div",{staticClass:"adress"},[i("i",{staticClass:"iconfont icon-tubiaozhizuomoban"}),i("p",[i("a",{staticStyle:{"text-decoration":"none",color:"inherit"},attrs:{href:"https://www.google.fr/maps/place/"+t.computedAddress,target:"_blank"}},[t._v(" "+t._s(t.ticketBasicDetail.client_address))])])]),i("div",{staticClass:"home_page"},[i("i",{staticClass:"iconfont icon-kuozhan",on:{click:t.handleShowMore}})]),i("div",{staticClass:"telephone"},[i("i",{staticClass:"iconfont icon-dianhua"}),i("span",[t._v(t._s(t.ticketBasicDetail.client_telephone))])]),i("div",{staticClass:"urgent"},[i("i",{staticClass:"iconfont icon-jiaji"}),i("span",[t._v(t._s(t.urgent))])]),i("div",{staticClass:"livreur"},[i("i",{staticClass:"iconfont icon-qishou"}),i("span",[t._v(t._s(t.livreur))])]),i("div",{staticClass:"ticketNote"},[i("i",{staticClass:"iconfont icon-beizhu"}),i("p",[t._v(t._s(t.ticketBasicDetail.ticket_note))])]),i("div",[i("i",{staticClass:"iconfont icon--tainjia",on:{click:function(e){t.show=!t.show}}})]),i("van-popup",{staticClass:"quickAdd",style:{height:"80%",width:"100%"},attrs:{round:""},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[i("div",{staticClass:"inputArea"},[i("div",{staticClass:"table_num"},[i("i",{staticClass:"iconfont icon-bianhao"}),i("input",{directives:[{name:"model",rawName:"v-model",value:t.ticketBasicDetail.table_num,expression:"ticketBasicDetail.table_num"}],attrs:{type:"text"},domProps:{value:t.ticketBasicDetail.table_num},on:{input:function(e){e.target.composing||t.$set(t.ticketBasicDetail,"table_num",e.target.value)}}})]),i("div",{staticClass:"platform"},[i("i",{staticClass:"iconfont icon-pingtai"}),i("van-dropdown-menu",[i("van-dropdown-item",{attrs:{options:t.platformOption},model:{value:t.ticketBasicDetail.delivery_platform,callback:function(e){t.$set(t.ticketBasicDetail,"delivery_platform",e)},expression:"ticketBasicDetail.delivery_platform"}})],1)],1),i("div",{staticClass:"delivery_time"},[i("i",{staticClass:"iconfont icon-shijian"}),i("input",{directives:[{name:"model",rawName:"v-model",value:t.ticketBasicDetail.delivery_time,expression:"ticketBasicDetail.delivery_time"}],attrs:{type:"text"},domProps:{value:t.ticketBasicDetail.delivery_time},on:{input:function(e){e.target.composing||t.$set(t.ticketBasicDetail,"delivery_time",e.target.value)}}})]),i("div",{staticClass:"urgent"},[i("i",{staticClass:"iconfont icon-jiaji"}),i("van-dropdown-menu",[i("van-dropdown-item",{attrs:{options:t.urgenceOption},model:{value:t.ticketBasicDetail.ticket_emergency,callback:function(e){t.$set(t.ticketBasicDetail,"ticket_emergency",e)},expression:"ticketBasicDetail.ticket_emergency"}})],1)],1),i("div",{staticClass:"name"},[i("i",{staticClass:"iconfont icon-kb-persion"}),i("input",{directives:[{name:"model",rawName:"v-model",value:t.ticketBasicDetail.client_name,expression:"ticketBasicDetail.client_name"}],attrs:{type:"text"},domProps:{value:t.ticketBasicDetail.client_name},on:{input:function(e){e.target.composing||t.$set(t.ticketBasicDetail,"client_name",e.target.value)}}})]),i("div",{staticClass:"telephone"},[i("i",{staticClass:"iconfont icon-dianhua"}),i("input",{directives:[{name:"model",rawName:"v-model",value:t.ticketBasicDetail.client_telephone,expression:"ticketBasicDetail.client_telephone"}],attrs:{type:"number"},domProps:{value:t.ticketBasicDetail.client_telephone},on:{input:function(e){e.target.composing||t.$set(t.ticketBasicDetail,"client_telephone",e.target.value)}}})]),i("div",{staticClass:"livreur"},[i("i",{staticClass:"iconfont icon-qishou"}),i("van-dropdown-menu",[i("van-dropdown-item",{attrs:{options:t.livreurOption},model:{value:t.ticketBasicDetail.delivery_man,callback:function(e){t.$set(t.ticketBasicDetail,"delivery_man",e)},expression:"ticketBasicDetail.delivery_man"}})],1)],1),i("div",{staticClass:"address"},[i("i",{staticClass:"iconfont icon-tubiaozhizuomoban"}),i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.ticketBasicDetail.client_address,expression:"ticketBasicDetail.client_address"}],attrs:{name:"",id:"",cols:"",rows:"3"},domProps:{value:t.ticketBasicDetail.client_address},on:{input:function(e){e.target.composing||t.$set(t.ticketBasicDetail,"client_address",e.target.value)}}})]),i("div",{staticClass:"ticket_note"},[i("i",{staticClass:"iconfont icon-beizhu"}),i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.ticketBasicDetail.ticket_note,expression:"ticketBasicDetail.ticket_note"}],attrs:{name:"",id:"",cols:"",rows:"3"},domProps:{value:t.ticketBasicDetail.ticket_note},on:{input:function(e){e.target.composing||t.$set(t.ticketBasicDetail,"ticket_note",e.target.value)}}})])]),i("div",{staticClass:"handleArea"},[i("v-btn",{staticClass:"buttonConfirm",attrs:{dark:"",rounded:"",color:"#217969",width:"100px"},on:{click:t.handleConfirm}},[t._v("确认")])],1),i("div",{staticClass:"pasteArea"},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.content,expression:"content"}],attrs:{type:"text",placeholder:"时间 | 姓名 | 地址 | 电话 |"},domProps:{value:t.content},on:{input:function(e){e.target.composing||(t.content=e.target.value)}}})]),i("div",{staticClass:"handleAreaQuick"},[i("v-btn",{staticClass:"buttonConfirm",attrs:{dark:"",rounded:"",color:"#217969",width:"100px"},on:{click:t.handleQuickConfirm}},[t._v("确认")]),i("v-btn",{staticClass:"buttonCancel",attrs:{dark:"",rounded:"",color:"#ff4a4a",width:"100px"},on:{click:t.handleCancel}},[t._v("取消")])],1)])],1)}),le=[],ue=i("53ca"),de=(i("09d3"),i("2d6d")),he=(i("61ae"),i("d314"));a["a"].use(ot["a"]).use(de["a"]).use(he["a"]);var pe={props:["ticketBasicDetail"],components:{VBtn:yt["a"]},data:function(){return{showMore:!1,show:!1,content:"",client:{},platformOption:[{text:"Ricepo",value:1},{text:"HungryP",value:2},{text:"Uber",value:3},{text:"JustEat",value:4},{text:"小程序",value:5},{text:"微信",value:6},{text:"官网",value:7},{text:"微米",value:8},{text:"方圆",value:9},{text:"呱呱",value:10},{text:"Deliveroo",value:11},{text:"无",value:12}],urgenceOption:[{text:"普通",value:0},{text:"优先",value:1},{text:"紧急",value:2}],livreurOption:[{text:"无",value:1},{text:"张俊",value:2},{text:"阿然",value:3},{text:"老马",value:4}]}},computed:{computedAddress:function(){if(this.ticketBasicDetail.client_address){console.log(Object(ue["a"])(this.ticketBasicDetail.client_address));var t=this.ticketBasicDetail.client_address.split(" ");return console.log(t),t.join("+")}return""},platform:function(){switch(this.ticketBasicDetail.delivery_platform){case 1:return"Ricepo";case 2:return"HungryPanda";case 3:return"Uber";case 4:return"JustEat";case 5:return"小程序";case 6:return"微信";case 7:return"官网";case 8:return"微米";case 9:return"方圆食里";case 10:return"呱呱到家";case 11:return"Deliveroo";case 12:return"";default:return""}},urgent:function(){switch(this.ticketBasicDetail.ticket_emergency){case 0:return"普通";case 1:return"优先";case 2:return"紧急";default:return"普通"}},livreur:function(){switch(this.ticketBasicDetail.delivery_man){case 1:return"无";case 2:return"张俊";case 3:return"阿然";case 4:return"老马";case 0:return"无";default:return""}}},methods:{handleHideDetail:function(){this.$parent.$parent.onHideDetail()},handleShowMore:function(){this.showMore=!this.showMore},handleConfirm:function(){this.content="",this.show=!1,this.$emit("patchTicketBasicDetail",this.ticketBasicDetail)},handleQuickConfirm:function(){console.log(this.content),this.$parent.onPatchTicketBasicDetailQuickly(this.content),this.content="",this.show=!1},handleCancel:function(){this.content="",this.show=!1}}},ve=pe,fe=(i("79a2"),Object(r["a"])(ve,re,le,!1,null,"246cc052",null)),ge=fe.exports;Ct()(fe,{VBtn:yt["a"]});var me=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"outWrapper"},[i("div",{ref:"categoryContainer",staticClass:"categoryContainer"},[i("ul",t._l(t.foodList,(function(e,a){return i("li",{key:e.subcategory_id,staticClass:"category-list",class:[t.currentIndex3===a?"categorySelect":"categoryNoselect"],on:{click:function(e){return t.selectFood(a)}}},[i("span",[t._v(t._s(e.subcategory))])])})),0)]),i("div",{ref:"dishWrapper",staticClass:"dishContainer"},[i("ul",t._l(t.foodList,(function(e){return i("li",{key:e.subcategory_id,staticClass:"categoryList category-list-hook"},[i("h3",{staticClass:"title"},[t._v(t._s(e.subcategory))]),i("ul",t._l(e.foods,(function(e){return i("li",{key:e.did,staticClass:"foodList"},[i("div",{staticClass:"firstline"},[i("p",{staticStyle:{"font-weight":"bold"}},[t._v(t._s(e.dname))]),i("p",{directives:[{name:"show",rawName:"v-show",value:e.selected,expression:"food.selected"}]},[t._v("已选 "+t._s(e.selected))])]),i("div",{staticClass:"secondline"},[i("p",{staticStyle:{color:"#ff4a4a"}},[t._v(t._s(e.dprice))]),i("div",[i("add-minus",{attrs:{food:e}})],1)])])})),0)])})),0)])])},ye=[],_e=(i("466d"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"quantity"},[i("button",{staticClass:"minus",style:{display:t.food.selecting?"block":"none"},on:{click:t.handleMinus}},[t._v("-")]),i("span",{directives:[{name:"show",rawName:"v-show",value:t.food.selecting,expression:"food.selecting"}],staticClass:"dish_quantity",staticStyle:{"text-align":"center",width:"2em",color:"#ff4a4a"}},[t._v(t._s(t.food.selecting))]),i("button",{staticClass:"add",attrs:{value:"+"},on:{click:t.handleAdd}},[t._v("+")])])}),ke=[],be={props:["food"],data:function(){return{}},mounted:function(){},methods:{handleAdd:function(){this.food.selecting?this.food.selecting+=1:a["a"].set(this.food,"selecting",1)},handleMinus:function(){this.food.selecting>0&&(this.food.selecting-=1)}}},we=be,xe=(i("65f8"),Object(r["a"])(we,_e,ke,!1,null,"2655872f",null)),Ce=xe.exports;function Se(t,e){return Te.apply(this,arguments)}function Te(){return Te=Object(Y["a"])(regeneratorRuntime.mark((function t(e,i){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log(e),t.prev=1,t.next=4,b()({url:"/testcreate/",method:"POST",data:e});case 4:console.log("创建成功",e.code),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](1),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[1,7]])}))),Te.apply(this,arguments)}function De(t){return $e.apply(this,arguments)}function $e(){return $e=Object(Y["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log(e),t.next=3,e.foodList.forEach((function(t){t.foods.forEach((function(t){if(t.selecting){var i=new Date,n=i.getFullYear().toString()+((i.getMonth()+1).toString().length<2?"0"+(i.getMonth()+1).toString():(i.getMonth()+1).toString())+i.getDate().toString()+(i.getHours().toString().length<2?"0"+i.getHours().toString():i.getHours().toString())+(i.getMinutes().toString().length<2?"0"+i.getMinutes().toString():i.getMinutes().toString())+(i.getSeconds().toString().length<2?"0"+i.getSeconds().toString():i.getSeconds().toString()),s={};a["a"].set(s,"order_id","D"+i.getTime().toString()+Math.floor(900*Math.random()+100).toString()),a["a"].set(s,"order_time",n),a["a"].set(s,"quantity",t.selecting),a["a"].set(s,"code",t.dcode),a["a"].set(s,"tid",e.ticket_id),a["a"].set(s,"o_note","无备注"),console.log(JSON.stringify(s)),console.log(s);try{Se(s,e)}catch(o){console.log(o)}}}))}));case 3:setTimeout((function(){Oe(e),e.$parent.getTicketOrder(),e.$parent.getTicketBasicDetail()}),300);case 4:case"end":return t.stop()}}),t)}))),$e.apply(this,arguments)}function Oe(t){return Pe.apply(this,arguments)}function Pe(){return Pe=Object(Y["a"])(regeneratorRuntime.mark((function t(e){var i,n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,b()("/testsubcategory/");case 2:return i=t.sent,t.next=5,b()("/testalldish/");case 5:if(n=t.sent,!e.ticket_id){t.next=19;break}return t.prev=7,t.next=10,b()("/testticketordergroupby2/"+e.ticket_id+"/");case 10:s=t.sent,i.data.forEach((function(t){t.foods=[],n.data.forEach((function(e){e.dsubcategory===t.subcategory_id&&(t.foods.push(e),s.data.forEach((function(i){i.dname===e.dname&&a["a"].set(t.foods[t.foods.indexOf(e)],"selected",i.total_quantity[0])})))}))})),e.foodList=i.data,e.ticketDetail=s,t.next=19;break;case 16:t.prev=16,t.t0=t["catch"](7),console.log(t.t0);case 19:e.$nextTick((function(){e.categoryScroll?e.categoryScroll.refresh():(e._initScroll(),e._calculateHeight())}));case 20:case"end":return t.stop()}}),t,null,[[7,16]])}))),Pe.apply(this,arguments)}var Ne={props:["ticket_id","wechatTicket"],components:{AddMinus:Ce},data:function(){return{categoryId:"101",foodList:[],ticketDetail:[],listHeight:[],scrollY:0}},mounted:function(){},computed:{currentIndex3:function(){for(var t=0;t<this.listHeight.length;t++){var e=this.listHeight[t],i=this.listHeight[t+1];if(!i||this.scrollY>=e&&this.scrollY<i)return t}return console.log("由于无height2，所以无法返回cunrrentIndex"),0}},methods:{currentIndex2:function(){console.log(this.listHeight.length);for(var t=0;t<this.listHeight.length;t++){var e=this.listHeight[t],i=this.listHeight[t+1];if(!i||this.scrollY>=e&&this.scrollY<i)return t}return console.log("由于无height2，所以无法返回cunrrentIndex"),0},getSubCategory:function(){var t=this;return Object(Y["a"])(regeneratorRuntime.mark((function e(){var i,n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,b()("/testsubcategory/");case 2:return i=e.sent,e.next=5,b()("/testalldish/");case 5:if(n=e.sent,!t.ticket_id){e.next=19;break}return e.prev=7,e.next=10,b()("/testticketordergroupby2/"+t.ticket_id+"/");case 10:s=e.sent,i.data.forEach((function(t){t.foods=[],n.data.forEach((function(e){e.dsubcategory===t.subcategory_id&&(t.foods.push(e),s.data.forEach((function(i){i.dname===e.dname&&a["a"].set(t.foods[t.foods.indexOf(e)],"selected",i.total_quantity[0])})))}))})),t.foodList=i.data,t.ticketDetail=s,e.next=19;break;case 16:e.prev=16,e.t0=e["catch"](7),console.log(e.t0);case 19:t.$nextTick((function(){t.categoryScroll?t.categoryScroll.refresh():(t._initScroll(),t._calculateHeight())}));case 20:case"end":return e.stop()}}),e,null,[[7,16]])})))()},selectFood:function(t){console.log(t);var e=this.$refs.dishWrapper.getElementsByClassName("category-list-hook"),i=e[t];this.dishScroll.scrollToElement(i,300)},_initScroll:function(){var t=this;this.categoryScroll=new mt["a"](".categoryContainer",{scrollY:!0,click:!0}),this.dishScroll=new mt["a"](".dishContainer",{scrollY:!0,click:!0,probeType:3}),this.dishScroll.on("scroll",(function(e){t.scrollY=Math.abs(Math.round(e.y))}))},_calculateHeight:function(){var t=this,e=this.$refs.dishWrapper.getElementsByClassName("category-list-hook"),i=0;this.listHeight.push(i),e.forEach((function(e){i+=e.clientHeight-5,t.listHeight.push(i)}))},submit:function(){De(this)},submitWechatOrder:function(t){var e=this;return Object(Y["a"])(regeneratorRuntime.mark((function i(){var n;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:console.log("开始新建order::::::::"),n=/\[(.*?)\]/,t.orders.forEach((function(i){if(t){var s=new Date,o=s.getFullYear().toString()+((s.getMonth()+1).toString().length<2?"0"+(s.getMonth()+1).toString():(s.getMonth()+1).toString())+s.getDate().toString()+(s.getHours().toString().length<2?"0"+s.getHours().toString():s.getHours().toString())+(s.getMinutes().toString().length<2?"0"+s.getMinutes().toString():s.getMinutes().toString())+(s.getSeconds().toString().length<2?"0"+s.getSeconds().toString():s.getSeconds().toString()),c={};a["a"].set(c,"order_id","D"+s.getTime().toString()+Math.floor(900*Math.random()+100).toString()),a["a"].set(c,"order_time",o),a["a"].set(c,"quantity",i.dishCount);var r=i.dishName.match(n);a["a"].set(c,"code",r[1]),a["a"].set(c,"tid",e.ticket_id),a["a"].set(c,"o_note","无备注"),console.log(JSON.stringify(c));try{Se(c,e)}catch(l){console.log(l)}}})),setTimeout((function(){Oe(e),e.$parent.getTicketOrder()}),300);case 4:case"end":return i.stop()}}),i)})))()}},beforeDestroy:function(){this.categoryScroll=null,this.dishScroll=null},watch:{"this.scrollY":function(){console.log("currentIndex变动了")},deep:!0,immediate:!0}},je=Ne,Le=(i("a656"),Object(r["a"])(je,me,ye,!1,null,"19c0d3b6",null)),Ae=Le.exports,Fe=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"nav"},[i("div",{staticClass:"nav_icon"},[i("i",{staticClass:"iconfont icon-gouwuche",staticStyle:{"margin-left":"15px",border:"border-radius: 50%","font-size":"2em",color:"rgba(7, 17, 27, 0.5)","font-weight":"normal"},on:{click:t.handleTicketClick}}),i("i",{staticClass:"iconfont icon-jiezhang",staticStyle:{"margin-left":"15px",border:"2px solid white","border-radius":"50%","font-size":"2em",color:"rgba(7, 17, 27, 0.5)","font-weight":"bolder"},on:{click:t.handlePayClick}})]),i("h3",[t._v("€"+t._s(t.total))]),i("div",{staticClass:"confirm",on:{click:t.handleSubmit}},[i("p",[t._v("添加")])])])},Be=[],Ee={props:["ticketDetail"],computed:{total:function(){var t=0;return this.$parent.$children[1].foodList?this.$parent.$children[1].foodList.forEach((function(e){e.foods.forEach((function(e){e.selected&&(t+=e.dprice*e.selected),e.selecting&&(t+=e.dprice*e.selecting)}))})):console.log("foodList为零"),(t*this.ticketDetail.ticket_discount-this.ticketDetail.ticket_reduction).toFixed(2)}},methods:{handleSubmit:function(){this.$emit("submit")},handleTicketClick:function(){this.$emit("handelTicketShow")},handlePayClick:function(){this.$emit("handelPayShow")}}},Ie=Ee,Re=(i("d702"),Object(r["a"])(Ie,Fe,Be,!1,null,"446219da",null)),He=Re.exports,qe=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"outer2",attrs:{id:"ticket_list"}},[i("div",{staticClass:"topNav"},[i("i",{staticClass:"iconfont icon-shangjiantou1",staticStyle:{"text-align":"right","margin-left":"0px",border:"2px solid white","border-radius":"50%","font-size":"2em",color:"black","font-weight":"bolder"},on:{click:t.handleTicketClick}}),i("p",{staticClass:"tableNum"},[t._v("桌号："+t._s(t.ticketBasicDetail.table_num))]),i("div",{staticClass:"allChange"},[i("p",[t._v("整单")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.checked,expression:"checked"}],staticClass:"check",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.checked)?t._i(t.checked,null)>-1:t.checked},on:{change:[function(e){var i=t.checked,a=e.target,n=!!a.checked;if(Array.isArray(i)){var s=null,o=t._i(i,s);a.checked?o<0&&(t.checked=i.concat([s])):o>-1&&(t.checked=i.slice(0,o).concat(i.slice(o+1)))}else t.checked=n},t.handleAllChange]}})])]),i("div",{attrs:{id:"ordered_list"}},t._l(t.ticketOrder,(function(e){return i("div",{key:e.order_id},[i("div",{staticClass:"order_container"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.checked,expression:"data.checked"}],staticClass:"check",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.checked)?t._i(e.checked,null)>-1:e.checked},on:{change:function(i){var a=e.checked,n=i.target,s=!!n.checked;if(Array.isArray(a)){var o=null,c=t._i(a,o);n.checked?c<0&&t.$set(e,"checked",a.concat([o])):c>-1&&t.$set(e,"checked",a.slice(0,c).concat(a.slice(c+1)))}else t.$set(e,"checked",s)}}}),i("div",{staticClass:"order"},[i("div",{staticClass:"dish_name"},[t._v(t._s(e.dname))]),i("input",{staticClass:"minus2",attrs:{type:"button",disabled:0===e.quantity,value:"-"},on:{click:function(i){return t.handleMinus(e)}}}),i("input",{directives:[{name:"model",rawName:"v-model.number",value:e.quantity,expression:"data.quantity",modifiers:{number:!0}}],staticClass:"dish_quantity",attrs:{type:"number"},domProps:{value:e.quantity},on:{input:function(i){i.target.composing||t.$set(e,"quantity",t._n(i.target.value))},blur:function(e){return t.$forceUpdate()}}}),i("input",{staticClass:"add2",attrs:{type:"button",value:"+"},on:{click:function(i){return t.handleAdd(e)}}}),i("div",{staticClass:"dish_note"},[t._v(t._s(e.note))])])])])})),0),i("div",{staticClass:"note",class:t.isShow?"indentation":"extention"},t._l(t.baseNoteList,(function(e){return i("p",{key:e.id,class:["note"+e.note_category_id,t.selectingNum.includes(e.id)?"checked":""],on:{click:function(i){return t.changeChecked(e.id,e.note_content)}}},[t._v(" "+t._s(e.note_content)+" ")])})),0),i("i",{staticClass:"iconfont icon-shangjiantou1",class:t.isShow?"down":"up",staticStyle:{"margin-left":"15px","border-radius":"50%","font-size":"1em",color:"black","font-weight":"bolder"},style:{transform:t.isShow?"rotate(180deg)":""},on:{click:function(e){t.isShow=!t.isShow}}}),i("div",{attrs:{id:"order_submit"}},[i("v-btn",{attrs:{dark:"",rounded:"",color:"#217969",width:"100px"},on:{click:t.handleSubmit2}},[t._v("提交")]),i("v-btn",{attrs:{dark:"",rounded:"",color:"#ff4a4a",width:"100px"},on:{click:t.showPopup}},[t._v("删整单")]),i("v-btn",{attrs:{dark:"",rounded:"",color:"#1E88E5",width:"100px"},on:{click:function(e){return t.btnClickPrint(0)}}},[t._v("打印C")]),i("v-btn",{attrs:{dark:"",rounded:"",color:"#1E88E5",width:"100px"},on:{click:function(e){return t.btnClickPrint(1)}}},[t._v("打印S")])],1),i("van-popup",{style:{height:"30%",width:"100%"},attrs:{id:"delete_submit",round:"",position:"bottom"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[i("v-btn",{attrs:{dark:"",rounded:"",color:"#217969",width:"100px"},on:{click:t.deleteAll}},[t._v("删所有菜")]),i("v-btn",{attrs:{dark:"",rounded:"",color:"#ff4a4a",width:"100px"},on:{click:t.deleteTable}},[t._v("删除订单")])],1)],1)},Me=[];function ze(t,e){!0===t.ticketOrder[e].checked?(console.log("this.selectingNoteContent::::::::::",t.selectingNoteContent.join(", ")),0!==t.selectingNoteContent.length?(console.log("note patch请求"),b()({url:"/testpatch/".concat(t.ticketOrder[e].order_id,"/"),method:"PATCH",data:{o_note:t.selectingNoteContent.join(", ")}}).then((function(e){t.selectingNoteContent=[],t.selectingNum=[],console.log(t.selectingNoteContent),console.log("note patch请求成功"),t.$parent.getTicketBasicDetail(),t.$parent.getTicketOrder()}))):(console.log("由于this.selectingNoteContent为空，不执行note patch请求"),t.$parent.getTicketBasicDetail(),t.$parent.getTicketOrder())):(t.selectingNoteContent=[],t.selectingNum=[],console.log(t.selectingNoteContent),t.$parent.getTicketBasicDetail(),t.$parent.getTicketOrder())}a["a"].use(ot["a"]);var We={props:["ticketBasicDetail","ticketOrder","ticket_id"],components:{VBtn:yt["a"]},data:function(){return{checked:!1,baseNoteList:[],selectedNote:[],selectingNum:[],selectingNoteContent:[],isShow:!0,show:!1}},mounted:function(){var t=this;b()({url:"/testbasenote/"}).then((function(e){t.baseNoteList=e.data,t.selectedNote=e.data.map((function(t){return a["a"].set(t,"selecting",!1),t}))}))},methods:{handleAllChange:function(){this.checked?this.ticketOrder.forEach((function(t){t.checked=!0})):this.ticketOrder.forEach((function(t){t.checked=!1}))},handleAdd:function(t){t.oldQuantity||(t.oldQuantity=t.quantity),t.quantity+=1},handleMinus:function(t){t.oldQuantity||(t.oldQuantity=t.quantity),t.quantity-=1},handleTicketClick:function(){var t=this;this.$emit("handelTicketShow"),b()({url:"/testticket/"+this.$route.params.table_num+"/"}).then((function(e){t.$store.commit("changeOrderDetail",e.data),t.$store.commit("changeChangingOrderDetail",e.data)}))},noteCategory:function(t){return{"data.note_category_id":!0}},changeChecked:function(t,e){console.log(e);var i=this.selectingNum.indexOf(t);-1!==i?this.selectingNum.splice(i,1):this.selectingNum.push(t);var a=this.selectingNoteContent.indexOf(e);console.log("current2::::::::",a),-1!==a?this.selectingNoteContent.splice(a,1):this.selectingNoteContent.push(e),console.log(this.selectingNoteContent)},notePatch:function(){var t=this;return Object(Y["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.ticketOrder.forEach((function(e,i){if(!0===e.checked)return b()({url:"/testpatch/".concat(e.order_id,"/"),method:"PATCH",data:{o_note:t.selectingNoteContent.join(", ")}})}));case 1:case"end":return e.stop()}}),e)})))()},patchQuantity:function(t){var e=this;return Object(Y["a"])(regeneratorRuntime.mark((function i(){var a;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,b()({url:"/testpatch/".concat(e.ticketOrder[t].order_id,"/"),method:"PATCH",data:{quantity:e.ticketOrder[t].quantity}});case 2:return a=i.sent,console.log(a),i.abrupt("return",a);case 5:case"end":return i.stop()}}),i)})))()},quantityPatch:function(){var t=this;return Object(Y["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.ticketOrder.forEach((function(e,i){e.quantity===e.oldQuantity||void 0===e.oldQuantity?console.log("数量相等,无需patch"):(console.log("不相等，需判断是patch或delete"),0===t.ticketOrder[i].quantity?(console.log("this.$store.state.table.changingOrderDetail[index].quantity:::::",t.ticketOrder[i].quantity),console.log("delete请求"),b()({url:"/testpatch/".concat(t.ticketOrder[i].order_id,"/"),method:"DELETE"})):(console.log("patch请求"),b()({url:"/testpatch/".concat(t.ticketOrder[i].order_id,"/"),method:"PATCH",data:{quantity:t.ticketOrder[i].quantity}})))}));case 2:case"end":return e.stop()}}),e)})))()},handleSubmit2:function(){var t=this;return Object(Y["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!==t.selectingNoteContent.length){e.next=13;break}return e.next=3,t.quantityPatch();case 3:return e.next=5,t.$parent.$refs.orderarea.getSubCategory();case 5:return t.checked=!1,e.next=8,t.$parent.getTicketOrder();case 8:console.log(t.ticketOrder),setTimeout((function(){t.$parent.patchTicketPrice(),console.log(t.ticketBasicDetail)}),500),setTimeout((function(){t.$parent.getTicketBasicDetail()}),600),e.next=27;break;case 13:return e.next=15,t.notePatch();case 15:return e.next=17,t.quantityPatch();case 17:return e.next=19,t.$parent.$refs.orderarea.getSubCategory();case 19:return t.checked=!1,e.next=22,t.$parent.patchTicketPrice();case 22:return e.next=24,t.$parent.getTicketOrder();case 24:setTimeout((function(){t.$parent.patchTicketPrice()}),1e3),t.selectingNoteContent=[],t.selectingNum=[];case 27:case"end":return e.stop()}}),e)})))()},handleSubmit:function(){var t=this;this.ticketOrder.forEach((function(e,i){console.log(e.quantity),console.log(e.oldQuantity),e.quantity===e.oldQuantity||void 0===e.oldQuantity?(console.log("相等,无需patch"),ze(t,i)):(console.log("不相等，需判断是patch或delete"),0===t.ticketOrder[i].quantity?(console.log("this.$store.state.table.changingOrderDetail[index].quantity:::::",t.ticketOrder[i].quantity),console.log("delete请求"),b()({url:"/testpatch/".concat(t.ticketOrder[i].order_id,"/"),method:"DELETE"}).then((function(e){console.log(e.data),ze(t,i)}))):(console.log("patch请求"),ze(t,i),b()({url:"/testpatch/".concat(t.ticketOrder[i].order_id,"/"),method:"PATCH",data:{quantity:t.ticketOrder[i].quantity}}).then((function(t){}))))})),this.$parent.getSubCategory()},showPopup:function(){this.show=!0},handleDelete:function(){this.ticketOrder.length>0&&this.ticketOrder.forEach((function(t){b()({url:"/testpatch/".concat(t.order_id,"/"),method:"DELETE"})}))},deleteAll:function(){var t=this;return Object(Y["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.handleDelete();case 2:t.$parent.getSubCategory(),setTimeout((function(){t.$parent.getTicketOrder(),t.$parent.patchTicketPrice()}),500),t.show=!1;case 5:case"end":return e.stop()}}),e)})))()},deleteTable:function(){var t=this;return Object(Y["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.handleDelete();case 2:console.log("即将删除:::::::::::",t.ticketBasicDetail.ticket_id),b()({url:"/testpatchtable/".concat(t.ticketBasicDetail.ticket_id,"/"),method:"DELETE"}).then((function(e){t.show=!1,t.$emit("hideDetail2")})).catch((function(t){console.log(t.message)}));case 4:case"end":return e.stop()}}),e)})))()},btnClickPrint:function(t){var e=this.ticketBasicDetail;console.log(e),e.orders=this.ticketOrder,e.ordersGroupBy=this.$parent.$refs.orderarea.ticketDetail.data,console.log(e);var i=new Date,a={};a.print_id=i.getTime().toString(),a.print_type=t,a.print_content=JSON.stringify(e),b()({url:"/testprintlist/",method:"POST",data:a})}},computed:{noteCategory2:function(){return function(t){return console.log(t.note_category_id),t.note_category_id}},ticketDetail:function(){return this.$parent.$children[1].ticketDetail}}},Ue=We,Je=(i("bdc2"),Object(r["a"])(Ue,qe,Me,!1,null,"7f524aa0",null)),Ve=Je.exports;Ct()(Je,{VBtn:yt["a"]});var Qe=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"outer2"},[i("div",{staticClass:"header"},[i("i",{staticClass:"iconfont icon-zuojiantou",staticStyle:{"text-align":"right","margin-left":"0px",border:"2px solid white","border-radius":"50%","font-size":"2em",color:"black","font-weight":"bolder"},on:{click:t.handleShow}}),i("p",[t._v("桌号："+t._s(t.ticketDetail.table_num))]),i("div",{staticClass:"payingAmount",on:{click:function(e){t.payingDishShow=!t.payingDishShow}}},[t._v("辅助："+t._s(t.payingAmount))])]),i("transition",{attrs:{name:"paying"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.payingDishShow,expression:"payingDishShow"}],staticClass:"payingDish"},[i("div",{staticStyle:{"text-align":"right","margin-right":"10px","font-size":"30px"},on:{click:function(e){t.payingDishShow=!t.payingDishShow}}},[t._v("x")]),i("div",{staticStyle:{display:"grid","grid-template-columns":"1fr 2fr","align-items":"center","border-bottom":"1px solid rgba(255, 255, 255, 0.5)"}},[i("p",{on:{click:function(e){t.payingList=[]}}},[t._v("重置")]),i("h3",{staticClass:"payingTotal"},[t._v("总："+t._s(t.payingAmount))])]),i("ul",{staticStyle:{"margin-top":"5px"}},t._l(t.payingList,(function(e){return i("li",{key:e.id,staticClass:"payingDetail",on:{click:function(i){return t.handlePayingDel(e)}}},[i("p",[t._v(t._s(e.name))]),i("p",[t._v(t._s(e.price))])])})),0)])]),i("div",{staticClass:"stickyArea"},[i("div",{attrs:{id:"total"}},[i("div",{staticClass:"tax",attrs:{id:"tax10"}},[i("p",{staticClass:"taxTitle"},[t._v("10%")]),i("p",[t._v(t._s(t.tatalTax10))])]),i("div",{staticClass:"tax",attrs:{id:"tax20"}},[i("p",{staticClass:"taxTitle"},[t._v("20%")]),i("p",[t._v(t._s(t.tatalTax20))])]),i("div",{staticClass:"tax",attrs:{id:"totalTax"}},[i("p",{staticClass:"taxTitle"},[t._v("总TVA")]),i("p",[t._v(t._s(t.tatalTax))])]),i("div",{staticClass:"tax",attrs:{id:"originalPrice"}},[i("p",{staticClass:"taxTitle"},[t._v("原价")]),i("p",[t._v(t._s(t.originalPrice))])]),i("div",{staticClass:"tax",attrs:{id:"discount"}},[i("p",{staticClass:"taxTitle"},[t._v("折扣")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.ticketDetail.ticket_discount,expression:"ticketDetail.ticket_discount"}],staticStyle:{width:"35px",height:"20px",border:"1px solid rgba(7, 17, 27, 0.1)","text-align":"center"},attrs:{type:"number"},domProps:{value:t.ticketDetail.ticket_discount},on:{focus:function(e){return t.focus(e)},change:t.postDiscount,input:function(e){e.target.composing||t.$set(t.ticketDetail,"ticket_discount",e.target.value)}}})]),i("div",{staticClass:"tax",attrs:{id:"reduction"}},[i("p",{staticClass:"taxTitle"},[t._v("减免")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.ticketDetail.ticket_reduction,expression:"ticketDetail.ticket_reduction"}],staticStyle:{width:"35px",height:"20px",border:"1px solid rgba(7, 17, 27, 0.1)","text-align":"center"},attrs:{type:"number"},domProps:{value:t.ticketDetail.ticket_reduction},on:{focus:function(e){return t.focus(e)},change:t.postReduction,input:function(e){e.target.composing||t.$set(t.ticketDetail,"ticket_reduction",e.target.value)}}})]),i("h2",{attrs:{id:"totalPrice"}},[t._v("总："+t._s(this.totalPrice))])]),i("div",{staticClass:"detailArea"},[i("div",{staticClass:"detail",staticStyle:{color:"#2CA4B0"}},[i("p",{staticClass:"title"},[t._v("转账")]),i("p",{staticClass:"amount"},[t._v(t._s(t.ticketDetail.pay_by_transfer))])]),i("div",{staticClass:"detail",staticStyle:{color:"#ff4a4a"}},[i("p",{staticClass:"title"},[t._v("现金")]),i("p",{staticClass:"amount"},[t._v(t._s(t.ticketDetail.pay_by_cash))])]),i("div",{staticClass:"detail",staticStyle:{color:"#217969"}},[i("p",{staticClass:"title"},[t._v("饭票")]),i("p",{staticClass:"amount"},[t._v(" "+t._s(t.ticketDetail.pay_by_ticket)+" ")]),i("p",{staticStyle:{"font-size":"10px","margin-top":"-5px"}},[t._v("("+t._s(t.ticketDetail.ticket_restaurant_count)+"张)")])]),i("div",{staticClass:"detail",staticStyle:{color:"#b48608"}},[i("p",{staticClass:"title"},[t._v("刷卡")]),i("p",{staticClass:"amount"},[t._v(t._s(t.ticketDetail.pay_by_card))])]),i("div",{staticClass:"detail"},[i("p",{staticClass:"title"},[t._v("支票")]),i("p",{staticClass:"amount"},[t._v(t._s(t.ticketDetail.pay_by_check))])]),i("div",{staticClass:"detail"},[i("p",{staticClass:"title"},[t._v("微信")]),i("p",{staticClass:"amount"},[t._v(t._s(t.ticketDetail.pay_by_wechat))])]),i("div",{staticClass:"detail"},[i("p",{staticClass:"title"},[t._v("阿里")]),i("p",{staticClass:"amount"},[t._v(t._s(t.ticketDetail.pay_by_alipay))])])])]),i("div",{staticClass:"handleArea"},[i("div",{staticClass:"handlePay"},[i("div",{staticClass:"payAmount"},[i("h5",[t._v("金额：")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.inputAmount,expression:"inputAmount"}],ref:"inputArea",staticStyle:{width:"60px",height:"40px","text-align":"left",border:"1px solid rgba(7, 17, 27, 0.1)"},attrs:{type:"number"},domProps:{value:t.inputAmount},on:{focus:function(e){return t.focus(e)},input:function(e){e.target.composing||(t.inputAmount=e.target.value)}}}),i("div",{staticClass:"totalPay",staticStyle:{"font-size":"14px"}},[t._v("已付："+t._s(t.alreadyPay))]),i("div",{staticClass:"restPay",staticStyle:{"font-size":"14px"}},[t._v("剩余："+t._s(t.restPay))]),i("div",{staticClass:"returnPay",staticStyle:{"font-size":"14px"}},[t._v("找零："+t._s(t.returnPay))])]),i("div",{staticClass:"payButton"},[i("v-btn",{on:{click:t.handlePayByVirement}},[t._v("转账")]),i("v-btn",{on:{click:t.handlePayByCash}},[t._v("现金")]),i("div",{staticClass:"history",staticStyle:{"grid-row":"1/6","grid-column":"3/4","background-color":"#eee","border-radius":"10px"}},[i("p",[t._v("付款记录")]),i("ul",t._l(t.paymentHistory,(function(e){return i("li",{key:e,staticStyle:{display:"flex","justify-content":"space-between"}},[i("p",[t._v(t._s(t.historyMethod(e)))]),i("p",[t._v(t._s(t.historyAmount(e)))])])})),0)]),i("v-btn",{on:{click:t.handlePayByTicket}},[t._v("饭票")]),i("v-btn",{on:{click:t.handlePayByCard}},[t._v("刷卡")]),i("v-btn",{on:{click:t.handlePayByCheck}},[t._v("支票")]),i("v-btn",{on:{click:t.handlePayByWechat}},[t._v("微信")]),i("v-btn",{on:{click:t.handlePayByAlipay}},[t._v("阿里")]),i("v-btn",{on:{click:t.changeTicketRestoCount}},[t._v("饭票张数")])],1)])]),i("div",{ref:"orderWrapper",staticClass:"ordered_list"},[i("ul",t._l(t.selectedDish,(function(e){return i("li",{key:e.order_id,staticClass:"order_container",on:{click:function(i){return t.handlePayingAdd(e)}}},[i("h4",{staticClass:"dish_name"},[t._v(t._s(Object.keys(e)[0]))]),i("p",{staticClass:"price"},[t._v(t._s(Object.values(e)[0].price))]),i("p",{staticClass:"quantity"},[t._v(t._s(Object.values(e)[0].quantity)+"份")]),i("p",{staticClass:"subTotal"},[t._v(t._s((Object.values(e)[0].price*Object.values(e)[0].quantity).toFixed(2)))])])})),0)]),i("div",{staticClass:"buttonArea"},[i("v-btn",{attrs:{dark:"",rounded:"",color:"#217969",width:"50%"},on:{click:t.handleSubmit}},[i("span",[t._v("提交")])]),i("v-btn",{attrs:{dark:"",rounded:"",color:"#ff4a4a",width:"50%"},on:{click:t.showPopup}},[t._v("删除")])],1),i("van-popup",{staticClass:"confirmArea",style:{height:"30%",width:"100%"},attrs:{id:"delete_submit",round:"",position:"bottom"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[i("v-btn",{attrs:{dark:"",rounded:"",color:"#ff4a4a",width:"50%"},on:{click:t.handleDelete}},[t._v("删除")]),i("v-btn",{attrs:{rounded:"",width:"50%"},on:{click:function(e){t.show=!1}}},[t._v("取消")])],1)],1)},Ye=[];a["a"].use(ot["a"]);var Ge={props:["payShow","ticketId"],components:{VBtn:yt["a"]},data:function(){return{inputAmount:"",reduction:0,ticketDetail:{},selectedDish:[],payCondition:{},payingList:[],payingDishShow:!1,show:!1}},mounted:function(){},computed:{historyMethod:function(){return function(t){if(this.ticketDetail.payment_history){console.log(t);var e=t.split(":");return e=e[0].split("_"),e[2]}return""}},historyAmount:function(){return function(t){if(this.ticketDetail.payment_history){var e=t.split(":");return e=e[1].split("}"),e[0]}return""}},paymentHistory:function(){return this.ticketDetail.payment_history?this.ticketDetail.payment_history.split(","):""},payingAmount:function(){var t=0;return this.payingList.forEach((function(e){t+=parseFloat(e.price)})),t.toFixed(2)},totalPrice:function(){return void 0!==this.selectedDish.length?(this.originalPrice*this.ticketDetail.ticket_discount-this.ticketDetail.ticket_reduction).toFixed(2):0},tatalTax10:function(){var t=0;if(void 0!==this.selectedDish.length){var e,i=Object(gt["a"])(this.selectedDish);try{for(i.s();!(e=i.n()).done;){var a=e.value;"0.10"===Object.values(a)[0].tax&&(t+=(Object.values(a)[0].price-Object.values(a)[0].price/(1+parseFloat(Object.values(a)[0].tax)))*Object.values(a)[0].quantity)}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0},tatalTax20:function(){var t=0;if(void 0!==this.selectedDish.length){var e,i=Object(gt["a"])(this.selectedDish);try{for(i.s();!(e=i.n()).done;){var a=e.value;"0.20"===Object.values(a)[0].tax&&(t+=Object.values(a)[0].tax*Object.values(a)[0].quantity)}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0},tatalTax:function(){return(parseFloat(this.tatalTax10)+parseFloat(this.tatalTax20)).toFixed(2)},originalPrice:function(){var t=0;if(void 0!==this.selectedDish.length){var e,i=Object(gt["a"])(this.selectedDish);try{for(i.s();!(e=i.n()).done;){var a=e.value;t+=Object.values(a)[0].price*Object.values(a)[0].quantity}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0},alreadyPay:function(){var t=this,e=0;return Object.keys(this.ticketDetail).forEach((function(i){i.includes("pay_by")&&(e+=parseFloat(t.ticketDetail[i]))})),e},restPay:function(){var t=this.totalPrice-this.alreadyPay;return t.toFixed(2)},returnPay:function(){return this.restPay<0?this.ticketDetail.pay_by_cash>=-this.restPay?-this.restPay:this.ticketDetail.pay_by_cash>0&&this.ticketDetail.pay_by_cash<-this.restPay?this.ticketDetail.pay_by_cash:0:0}},methods:{handleShow:function(){this.orderScroll=null,this.$emit("hidedetail")},focus:function(t){t.currentTarget.select()},handlePayClick:function(){this.payingList=[],this.$store.commit("changePayShow")},_initScroll:function(){this.orderScroll=new mt["a"](".ordered_list",{scrollY:!0,click:!0})},handlePayByVirement:function(){""!==this.inputAmount&&this.pay("pay_by_transfer",this.ticketDetail.pay_by_transfer)},handlePayByCash:function(){""!==this.inputAmount&&this.pay("pay_by_cash",this.ticketDetail.pay_by_cash)},handlePayByTicket:function(){""!==this.inputAmount&&this.pay("pay_by_ticket",this.ticketDetail.pay_by_ticket)},handlePayByCard:function(){""!==this.inputAmount&&this.pay("pay_by_card",this.ticketDetail.pay_by_card)},handlePayByCheck:function(){""!==this.inputAmount&&this.pay("pay_by_check",this.ticketDetail.pay_by_check)},handlePayByWechat:function(){""!==this.inputAmount&&this.pay("pay_by_wechat",this.ticketDetail.pay_by_wechat)},handlePayByAlipay:function(){""!==this.inputAmount&&this.pay("pay_by_alipay",this.ticketDetail.pay_by_alipay)},handleSubmit:function(){var t=this;"0.00"===this.restPay?(this.ticketDetail.payment_status=2,b()({url:"/testticketdetailpaied/".concat(this.ticketId,"/"),method:"PATCH",data:this.ticketDetail}).then((function(e){t.$router.go(0)})).catch((function(t){return console.log(t)}))):alert("剩余".concat(this.restPay,"未结清"))},showPopup:function(){this.show=!0},handleDelete:function(){var t=this;b()({url:"/testticketdetailpaied/".concat(this.ticketId,"/"),method:"DELETE"}).then((function(e){alert("删除成功"),t.$router.push("/salle")})).catch((function(t){return console.log(t)}))},handlePayingAdd:function(t){var e=new Date,i={};a["a"].set(i,"id",e.getTime()),a["a"].set(i,"name",Object.keys(t)[0]),a["a"].set(i,"price",Object.values(t)[0].price),this.payingList.push(i),console.log(this.payingList)},handlePayingDel:function(t){console.log(this.payingList.indexOf(t));var e=this.payingList.indexOf(t);this.payingList.splice(e,1)},pay:function(t,e){var i=this;if(""!==this.inputAmount){var a=(Number(e)+Number(this.inputAmount)).toFixed(2),n='{"'+t+'": '+a+"}";console.log(n),console.log(JSON.parse(n));var s=JSON.parse(n);s.payment_history=this.ticketDetail.payment_history,""===s.payment_history?s.payment_history="{"+t+":"+this.inputAmount+"}":s.payment_history+=",{"+t+":"+this.inputAmount+"}",console.log(s),b()({url:"/testpatchticket/".concat(this.ticketId,"/"),method:"PATCH",data:s}).then((function(){i.refreshPay(i)})).catch((function(t){return console.log(t)})),this.$refs.inputArea.select()}},changeTicketRestoCount:function(){var t=this;if(console.log("number"===typeof this.inputAmount),console.log(this.inputAmount%1===0),""!==this.inputAmount&&"number"===typeof Number(this.inputAmount)&&this.inputAmount%1===0){console.log("判断为真");var e=Number(this.ticketDetail.ticket_restaurant_count)+Number(this.inputAmount),i='{"ticket_restaurant_count": '+e+"}",a=JSON.parse(i);b()({url:"/testpatchticket/".concat(this.ticketId,"/"),method:"PATCH",data:a}).then((function(){t.refreshPay(t)})).catch((function(t){return console.log(t)})),this.$refs.inputArea.select()}},refreshPay:function(t){function e(){return i.apply(this,arguments)}function i(){return i=Object(Y["a"])(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b()({url:"/testticketdetailpaied/".concat(t.ticketId,"/")});case 3:i=e.sent,console.log(i.data),t.ticketDetail=i.data,e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))),i.apply(this,arguments)}e()},postReduction:function(){var t=this,e={ticket_reduction:this.ticketDetail.ticket_reduction,ticket_price:this.totalPrice};b()({url:"/testpatchticket/".concat(this.ticketId,"/"),method:"PATCH",data:e}).then((function(){t.refreshPay(t)})).catch((function(t){return console.log(t)}))},postDiscount:function(){var t=this,e={ticket_discount:this.ticketDetail.ticket_discount,ticket_price:this.totalPrice};b()({url:"/testpatchticket/".concat(this.ticketId,"/"),method:"PATCH",data:e}).then((function(){t.refreshPay(t)})).catch((function(t){return console.log(t)}))},historyMethod2:function(t){if(this.ticketDetail.payment_history){console.log(t);var e=t.split(":");return e=e[0].split("_"),e[2]}},historyAmount2:function(t){if(console.log(t),this.ticketDetail.payment_history){var e=t.split(":");return e=e[1].split("}"),e[0]}return""}},watch:{payShow:function(){var t=this;b()({url:"/testticketdetailpaied/".concat(this.ticketId,"/")}).then((function(e){t.ticketDetail=e.data})).catch((function(t){return console.log(t)})),b()({url:"/testticketordergroupby2/".concat(this.ticketId,"/")}).then((function(e){console.log(e.data),t.selectedDish=e.data.map((function(t){var e={};return e[t.dname]={quantity:t.total_quantity[0],price:t.dprice,tax:t.dtax},e})),t.$nextTick((function(){t.detailShow&&(t.orderScroll?t.orderScroll.refresh():t._initScroll())}))})).catch((function(t){return console.log(t)}))}}},Ze=Ge,Ke=(i("7b00"),Object(r["a"])(Ze,Qe,Ye,!1,null,"158d8fc5",null)),Xe=Ke.exports;Ct()(Ke,{VBtn:yt["a"]});var ti={props:["ticket_id","wechatTicket","detailShow"],components:{TopNav:ge,OrderArea:Ae,BottomNav:He,Ticket:Ve,Pay:Xe},data:function(){return{ticketBasicDetail:{},ticketOrder:[],ticketShow:!1,payShow:!1}},mounted:function(){this.$store.commit("hide")},methods:{onSubmit:function(){var t=this;return Object(Y["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("监听到刷新请求"),e.next=3,t.$refs.orderarea.submit();case 3:t.$nextTick((function(){t.patchTicketPrice()}));case 4:case"end":return e.stop()}}),e)})))()},submitWechat:function(){},onTicketShow:function(){this.ticketShow=!this.ticketShow},onHideDetail:function(){this.$emit("hideDetail")},onHideDetail2:function(){console.log("触发了onHideDetail2"),this.ticketShow=!this.ticketShow,this.$parent.onHideDetail()},onPayShow:function(){this.payShow=!0},onHidePay:function(){this.getTicketBasicDetail(),this.payShow=!1},getTicketBasicDetail:function(){var t=this;return Object(Y["a"])(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.ticket_id){e.next=6;break}return e.next=3,b()("/testticketdetailpaied/".concat(t.ticket_id,"/"));case 3:i=e.sent,t.ticketBasicDetail=i.data,console.log(t.ticketBasicDetail);case 6:case"end":return e.stop()}}),e)})))()},onPatchTicketBasicDetail:function(t){var e=this;b()({url:"/testticketdetailpaied/".concat(this.ticket_id,"/"),method:"PATCH",data:t}).then((function(){e.getTicketBasicDetail()}))},patchWechatTicketBasicDetail:function(t){var e=this;console.log(this.$store.state.wechatTicket),console.log(this.wechatTicket.clientName),this.$nextTick((function(){b()({url:"/testticketdetailpaied/".concat(e.ticket_id,"/"),method:"PATCH",data:t}).then((function(){e.getTicketBasicDetail()}))}))},onPatchTicketBasicDetailQuickly:function(t){var e=this;console.log("进入Quickly");var i=/\|/g,a=i.exec(t);if(console.log(a),a){var n=t.split("|"),s=n[0],o=n[1],c=n[2],r=n[3],l=n[4];console.log(s,o,c,r,l);var u={delivery_time:s,client_name:o,client_address:c,client_telephone:r,ticket_note:l};console.log(u),b()({url:"/testticketdetailpaied/".concat(this.ticket_id,"/"),method:"PATCH",data:u}).then((function(){e.getTicketBasicDetail()}))}},getTicketOrder:function(){var t=this;return Object(Y["a"])(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("获取ticket.vue用：",t.ticket_id),e.prev=1,e.next=4,b()("/testticket2/".concat(t.ticket_id,"/"));case 4:return i=e.sent,t.ticketOrder=i.data,console.log(i.data),e.abrupt("return",i);case 10:e.prev=10,e.t0=e["catch"](1),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})))()},patchTicketPrice:function(){var t=this;return Object(Y["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("开始patch价格",t.$refs.bottomnav.total),e.abrupt("return",b()({url:"/testticketdetailpaied/".concat(t.ticket_id,"/"),method:"PATCH",data:{ticket_price:t.$refs.bottomnav.total}}));case 2:case"end":return e.stop()}}),e)})))()},patchWechatTicketPrice:function(){var t=0;switch(this.wechatTicket.orders.forEach((function(e){t+=Number(e.dishCount)*Number(e.dishPrice)})),!0){case t>100:t-=8;break;case t>75:t-=5;break;case t>50:t-=3;break;default:break}b()({url:"/testticketdetailpaied/".concat(this.ticket_id,"/"),method:"PATCH",data:{ticket_price:t}}).then((function(t){return console.log(t)}))}},beforeDestroy:function(){},watch:{detailShow:function(){this.getTicketBasicDetail()}}},ei=ti,ii=(i("cf76"),Object(r["a"])(ei,oe,ce,!1,null,"0c7d7e68",null)),ai=ii.exports,ni=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"outer"},[i("div",{staticClass:"top"},[i("i",{staticClass:"iconfont icon-zuojiantou",on:{click:function(e){return t.$emit("hideWechat")}}}),i("v-btn",{on:{click:t.getData}},[t._v("刷新数据")])],1),i("div",{staticStyle:{}},[i("ul",{staticClass:"listContainer"},t._l(t.info,(function(e){return i("li",{key:e.ticketNumber,on:{click:function(i){return t.handleClick(e)}}},[i("div",{staticClass:"ticketContainer"},[i("v-btn",{attrs:{small:"",rounded:""},on:{click:function(i){return i.stopPropagation(),t.handleCrawl(e)}}},[t._v("调取")]),i("p",[t._v(t._s(e.ticketType))]),i("p",[t._v(t._s(e.ticketNumber))]),i("p",[t._v(t._s(e.clientName))]),i("p",{staticStyle:{"font-size":"14px"}},[t._v(t._s(e.deliveryTime))])],1)])})),0)]),i("transition",{attrs:{name:"detail"}},[i("wechat-detail",{directives:[{name:"show",rawName:"v-show",value:t.detailShow,expression:"detailShow"}],attrs:{ticket:t.ticket}})],1)],1)},si=[],oi=(i("5319"),i("e7e5"),i("d399")),ci=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"outer"},[i("div",{staticClass:"top"},[i("i",{staticClass:"iconfont icon-zuojiantou",on:{click:function(e){return t.$parent.handleDetailShow()}}})]),i("div",{staticClass:"info"},[i("p",[t._v("单号："+t._s(t.ticket.ticketNumber))]),i("p",[t._v("类型："+t._s(t.ticket.type))]),i("p",[t._v("昵称："+t._s(t.ticket.clientName))]),i("div",{staticStyle:{display:"grid","grid-template-columns":"repeat(2, auto)","align-items":"center"}},[i("p",[t._v("时间：")]),i("p",{staticStyle:{"font-size":"14px"}},[t._v(t._s(t.ticket.deliveryTime))])]),i("p",{staticStyle:{"grid-column":"1/3","text-align":"start"}},[t._v("地址： "),i("a",{staticStyle:{"text-decoration":"none",color:"inherit"},attrs:{href:"https://www.google.fr/maps/place/"+t.computedAddress,target:"_blank"}},[t._v(" "+t._s(t.ticket.address))])]),i("p",[t._v("邮编："+t._s(t.ticket.zipCode))]),i("p",[t._v("电话："+t._s(t.ticket.tel))]),i("p",{staticStyle:{"grid-column":"1/3","text-align":"start"}},[t._v("下单时间："+t._s(t.ticket.orderTime))]),i("div",{staticStyle:{"grid-column":"1/3","text-align":"start",display:"grid","grid-template-columns":"repeat(2, auto"}},[i("p",[t._v("备注：")]),i("p",{staticStyle:{color:"rgb(255, 74, 74)"}},[t._v(t._s(t.ticket.ticketNote))])])]),i("div",{staticClass:"order"},[i("div",{staticClass:"total",staticStyle:{"margin-top":"5px","text-align":"right"}},[i("p",{staticStyle:{"font-weight":"600"}},[t._v("Total: "+t._s(t.total))]),t.originTotal>=50?i("p",[t._v("原价："+t._s(t.originTotal))]):t._e(),t.originTotal>=100?i("p",[t._v("满100减8")]):t.originTotal>=75?i("p",[t._v("满75减5")]):t.originTotal>=50?i("p",[t._v("满50减3")]):t._e()]),i("ul",t._l(t.ticket.orders,(function(e){return i("li",{key:e.dishName},[i("p",{staticStyle:{"text-align":"start"}},[t._v(t._s(e.dishName))]),i("p",{class:{multi:e.dishCount>1}},[t._v(t._s(e.dishCount))]),i("p",[t._v(t._s(e.dishPrice))])])})),0)]),i("div",[i("v-btn",{staticStyle:{"margin-top":"20px"},attrs:{dark:"",rounded:"",color:"#217969"},on:{click:t.handleCrawlInner}},[t._v(" 调取 ")])],1)])},ri=[],li={props:["ticket"],data:function(){return{}},computed:{computedAddress:function(){if(this.ticket.address){var t=this.ticket.address.split(" ");return t.join("+")}return""},originTotal:function(){var t=0;return this.ticket.orders?(this.ticket.orders.forEach((function(e){t+=Number(e.dishCount)*Number(e.dishPrice)})),t.toFixed(2)):0},total:function(){var t=0;return this.ticket.orders?(this.ticket.orders.forEach((function(e){t+=Number(e.dishCount)*Number(e.dishPrice)})),t>=100?t-=8:t>=75?t-=5:t>=50&&(t-=3),t.toFixed(2)):0}},methods:{handleCrawlInner:function(){this.$parent.handleDetailShow(),this.$parent.$parent.onHideWechat(),this.$parent.$parent.onCreateNewWechatTicket(this.ticket)}}},ui=li,di=(i("5046"),Object(r["a"])(ui,ci,ri,!1,null,"552807b8",null)),hi=di.exports;Ct()(di,{VBtn:yt["a"]});var pi={components:{WechatDetail:hi},data:function(){return{detailShow:!1,webSrc:"http://www.xinweiyun.com/weixin/index.php/admin/wapindex.jtml??"+Math.random(),webSrc2:"http://www.newsavour.com/restaurants/",info:[],ticket:{},direction:"top",fab:!1,fling:!1,hover:!1,tabs:null,top:!1,right:!0,bottom:!0,left:!1,transition:"slide-y-reverse-transition"}},created:function(){b.a.interceptors.request.use((function(t){return oi["a"].loading({message:"加载中...",forbidClick:!0,overlay:!1,closeOnClickOverlay:!0,loadingType:"spinner",duration:5e3}),t}),(function(t){return Promise.reject(t)})),b.a.interceptors.response.use((function(t){return oi["a"].clear(),t}),(function(t){return Promise.reject(t)}))},mounted:function(){this.getData()},computed:{activeFab:function(){switch(this.tabs){case"one":return{class:"purple",icon:"account_circle"};case"two":return{class:"red",icon:"edit"};case"three":return{class:"green",icon:"keyboard_arrow_up"};default:return{}}}},methods:{getCookie:function(){console.log(document.cookie)},handleDetailShow:function(){this.detailShow=!this.detailShow},getData:function(){var t=this;this.info=[],b()({url:"/testAxios2/"}).then((function(e){for(var i=/<A class="color364 displayordera.*?jtml">(.*?)<\/A>.*?(\d{7}).*?col_12"><span>(\d+\.\d+).*?col_9"><span>(.*?)-货到付款.*?(\d+-\d+-\d+ \d+:\d+:\d+)<\/span><\/li><li class="col_8"><span>(.*?)<\/span>.*?col_8"><span>(.*?)<\/span><\/li><li class="col_11.*?<div class="orderclone">/g,n={},s=0;s<20;s++){var o=i.exec(Object.values(e)[0]);n={},a["a"].set(n,"clientName",o[1]),a["a"].set(n,"ticketNumber",o[2]),a["a"].set(n,"ticketPrice",o[3]),a["a"].set(n,"ticketType",o[4]),a["a"].set(n,"orderTime",o[5]),a["a"].set(n,"deliveryTime",o[6]),a["a"].set(n,"ticketNote",o[7]),t.info.push(n)}}))},getDetail:function(t){var e=this;return Object(Y["a"])(regeneratorRuntime.mark((function i(){var n;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return n=[],i.abrupt("return",b()("/testAxios/".concat(t.ticketNumber,"/")).then((function(i){for(var s=/new_table new_table_chlid.*?<span title="(.*?)">.*?id="sl" value="(.*?)".*?id="jg" value="(.*?)".*?nbsp;分/g,o=Object.values(i.data[0])[0].match(s),c=0,r=0;r<o.length;r++){var l=s.exec(Object.values(i.data[0])[0]);n.push({dishName:l[1],dishCount:l[2],dishPrice:l[3]}),c+=l[2]*l[3]}if(console.log(c),a["a"].set(e.ticket,"orders",n),"外卖"===t.ticketType){var u=/id="psdz" value="(.*?\n?.*?)".*?name="customerZipCodeNum".*?value="(.*?)".*?name="tel".*?value="(.*?)".*?/g,d=u.exec(Object.values(i.data[0])[0]),h=d[1].split("起送")[1];console.log(h),h=h.replace(/\n/g," ");var p=/^.*?[市|岛|区|街]?.*[市|岛|区|街](.*?)$/g.exec(h);switch(p&&(h=p[1]),a["a"].set(e.ticket,"address",h+" "+d[2]),a["a"].set(e.ticket,"zipCode",d[2]),a["a"].set(e.ticket,"tel",d[3]),a["a"].set(e.ticket,"type",t.ticketType),a["a"].set(e.ticket,"clientName",t.clientName),a["a"].set(e.ticket,"ticketNumber",t.ticketNumber),a["a"].set(e.ticket,"deliveryTime",t.deliveryTime),a["a"].set(e.ticket,"orderTime",t.orderTime),a["a"].set(e.ticket,"ticketNote",t.ticketNote),!0){case c>100:a["a"].set(e.ticket,"reduction",8);break;case c>75:a["a"].set(e.ticket,"reduction",5);break;case c>50:a["a"].set(e.ticket,"reduction",3);break;default:a["a"].set(e.ticket,"reduction",0);break}a["a"].set(e.ticket,"ticketPrice",c-e.ticket.reduction)}else{var v=/id="psdz" value="(.*?)".*?name="tel".*?value="(.*?)".*?/g,f=v.exec(Object.values(i.data[0])[0]),g=f[1].split("起送")[1];a["a"].set(e.ticket,"address",g),a["a"].set(e.ticket,"tel",f[2]),a["a"].set(e.ticket,"type",t.ticketType),a["a"].set(e.ticket,"clientName",t.clientName),a["a"].set(e.ticket,"ticketNumber",t.ticketNumber),a["a"].set(e.ticket,"deliveryTime",t.deliveryTime),a["a"].set(e.ticket,"orderTime",t.orderTime),a["a"].set(e.ticket,"ticketNote",t.ticketNote)}})));case 2:case"end":return i.stop()}}),i)})))()},handleClick:function(t){this.handleDetailShow(),this.getDetail(t)},handleCrawl:function(t){var e=this;return Object(Y["a"])(regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,e.getDetail(t);case 2:e.detailShow=!1,e.$emit("createNewWechatTicket",e.ticket),e.$emit("hideWechat");case 5:case"end":return i.stop()}}),i)})))()}},watch:{}},vi=pi,fi=(i("0a20"),Object(r["a"])(vi,ni,si,!1,null,"aad64e0a",null)),gi=fi.exports;Ct()(fi,{VBtn:yt["a"]});var mi=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"outer"},[i("div",{staticClass:"title"},[i("i",{staticClass:"iconfont icon-zuojiantou",staticStyle:{"font-size":"2em",color:"black","font-weight":"bolder"},on:{click:t.handleHide}}),i("p",[t._v("汇总信息")])]),i("div",{staticClass:"dishList"},[i("ul",t._l(t.groupbyList,(function(e){return i("li",{key:e.did},[i("p",{staticClass:"emergency"},[t._v(t._s(t.computedEmergency(e.orders)))]),i("p",{staticClass:"quantity",class:{plusOne:e.total_quantity[0]>1}},[t._v(t._s(e.total_quantity[0]))]),i("p",{staticClass:"dish_name"},[t._v(t._s(e.dname))]),i("p",{directives:[{name:"show",rawName:"v-show",value:t.noteShow(e.orders),expression:"noteShow(item.orders)"}],staticStyle:{"white-space":"pre-wrap","text-align":"left"}},[t._v(t._s(t.note(e.orders)))])])})),0)]),i("div",{staticStyle:{position:"fixed",bottom:"20px",width:"100%"}},[i("v-btn",{staticClass:"submit",attrs:{rounded:""},on:{click:function(e){return t.btnClickPrint(2)}}},[t._v("打印")])],1)])},yi=[],_i=(i("a623"),{props:["groupbyList"],computed:{computedEmergency:function(){return function(t){return console.log(t.every((function(t){return 0===t.ticket_emergency[0]}))),t.every((function(t){return 0===t.ticket_emergency[0]}))?"":"优先"}},noteShow:function(){return function(t){return!t.every((function(t){return"无备注"===t.o_note}))}},note:function(){return function(t){var e="";return t.forEach((function(t){"无备注"!==t.o_note&&(e+=t.quantity+"份"+t.o_note+" ;\n")})),e}}},methods:{handleHide:function(){this.$emit("hideGroupby")},btnClickPrint:function(t){console.log(this.groupbyList);var e,i=Object(gt["a"])(this.groupbyList);try{for(i.s();!(e=i.n()).done;){var n=e.value;if(!n.orders.every((function(t){return"无备注"===t.o_note}))){var s="";n.orders.forEach((function(t){"无备注"!==t.o_note&&(s+="  "+t.quantity+"份"+t.o_note+" ;\n"),0!==t.ticket_emergency[0]&&(o=1)})),a["a"].set(n,"note_content",s)}var o=0;n.orders.forEach((function(t){0!==t.ticket_emergency[0]&&(o=1)})),a["a"].set(n,"emergency",o)}}catch(u){i.e(u)}finally{i.f()}var c=this.groupbyList;console.log(c);var r=new Date,l={};l.print_id=r.getTime().toString(),l.print_type=t,l.print_content=JSON.stringify(c),b()({url:"/testprintlist/",method:"POST",data:l})}}}),ki=_i,bi=(i("51bc"),Object(r["a"])(ki,mi,yi,!1,null,"2981e9ee",null)),wi=bi.exports;function xi(t){return Ci.apply(this,arguments)}function Ci(){return Ci=Object(Y["a"])(regeneratorRuntime.mark((function t(e){var i,n,s,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,b()({url:"/testticketlistnopaied/"});case 2:i=t.sent,e.ticketList=Object.values(i.data),e.ticketList=e.ticketList.filter((function(t){return 2===t.type})),n=Object(gt["a"])(e.ticketList);try{for(n.s();!(s=n.n()).done;)o=s.value,a["a"].set(o,"checked",!1)}catch(c){n.e(c)}finally{n.f()}console.log(e.ticketList),e.$nextTick((function(){e.orderScroll?e.orderScroll.refresh():e._initScroll()}));case 9:case"end":return t.stop()}}),t)}))),Ci.apply(this,arguments)}Ct()(bi,{VBtn:yt["a"]});var Si={components:{DeliveryDetail:ai,TicketList:Ut,Summary:Zt,WechatList:gi,DishGroupby:wi},data:function(){return{fab:!1,activeTab:2,ticketList:[],wechatTicket:{},detailShow:!1,wechatShow:!1,groupbyShow:!1,arrangementShow:!1,ticketId:"",groupbyList:[],testshow:!1}},mounted:function(){xi(this),this.$store.commit("show")},computed:{type:function(){return function(t){return 0===t.type?"堂食":1===t.type?"打包":"外送"}},title:function(){return function(t){return 0===t.type?"桌号："+t.table_num:1===t.type?"打包":"编号："+t.table_num}},totalPrice:function(){var t=0;if(void 0!==this.ticketList.length){var e,i=Object(gt["a"])(this.ticketList);try{for(i.s();!(e=i.n()).done;){var a=e.value;t+=parseFloat(a.ticket_price)}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0},tatalTax10:function(){var t=0;if(void 0!==this.ticketList.length){var e,i=Object(gt["a"])(this.ticketList);try{for(i.s();!(e=i.n()).done;){var a=e.value;t+=parseFloat(a.ticket_tax10)}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0},tatalTax20:function(){var t=0;if(void 0!==this.ticketList.length){var e,i=Object(gt["a"])(this.ticketList);try{for(i.s();!(e=i.n()).done;){var a=e.value;t+=parseFloat(a.ticket_tax20)}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0},tatalTax:function(){return(parseFloat(this.tatalTax10)+parseFloat(this.tatalTax20)).toFixed(2)},totalVirement:function(){var t=0;if(void 0!==this.ticketList.length){var e,i=Object(gt["a"])(this.ticketList);try{for(i.s();!(e=i.n()).done;){var a=e.value;t+=parseFloat(a.pay_by_transfer)}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0},totalCash:function(){var t=0;if(void 0!==this.ticketList.length){var e,i=Object(gt["a"])(this.ticketList);try{for(i.s();!(e=i.n()).done;){var a=e.value;t+=parseFloat(a.pay_by_cash)}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0},totalTicket:function(){var t=0;if(void 0!==this.ticketList.length){var e,i=Object(gt["a"])(this.ticketList);try{for(i.s();!(e=i.n()).done;){var a=e.value;t+=parseFloat(a.pay_by_ticket)}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0},totalCard:function(){var t=0;if(void 0!==this.ticketList.length){var e,i=Object(gt["a"])(this.ticketList);try{for(i.s();!(e=i.n()).done;){var a=e.value;t+=parseFloat(a.pay_by_card)}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0},totalCheck:function(){var t=0;if(void 0!==this.ticketList.length){var e,i=Object(gt["a"])(this.ticketList);try{for(i.s();!(e=i.n()).done;){var a=e.value;t+=parseFloat(a.pay_by_check)}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0},totalWechat:function(){var t=0;if(void 0!==this.ticketList.length){var e,i=Object(gt["a"])(this.ticketList);try{for(i.s();!(e=i.n()).done;){var a=e.value;t+=parseFloat(a.pay_by_wechat)}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0},totalAlipay:function(){var t=0;if(void 0!==this.ticketList.length){var e,i=Object(gt["a"])(this.ticketList);try{for(i.s();!(e=i.n()).done;){var a=e.value;t+=parseFloat(a.pay_by_alipay)}}catch(n){i.e(n)}finally{i.f()}return t.toFixed(2)}return 0}},methods:{getTicket:function(){var t=this;return Object(Y["a"])(regeneratorRuntime.mark((function e(){var i,n,s,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,b()({url:"/testticketlistnopaied/"});case 2:i=e.sent,3===t.activeTab?t.ticketList=Object.values(i.data):t.ticketList=Object.values(i.data).filter((function(e){return e.type===t.activeTab})),n=Object(gt["a"])(t.ticketList);try{for(n.s();!(s=n.n()).done;)o=s.value,a["a"].set(o,"checked",!1)}catch(c){n.e(c)}finally{n.f()}t.$nextTick((function(){t.orderScroll?(t.orderScroll.refresh(),console.log("刷新了Bs")):(t._initScroll(),console.log("创建了新的Bs"))}));case 7:case"end":return e.stop()}}),e)})))()},onHandleDetailShow:function(t){var e=this;console.log(t.ticket_id),this.ticketId=t.ticket_id,setTimeout((function(){e.$refs.deliverydetail.$refs.orderarea.getSubCategory(),e.$refs.deliverydetail.getTicketOrder(),e.$refs.deliverydetail.getTicketBasicDetail()}),0),this.detailShow=!this.detailShow},onHideDetail:function(t){this.getTicket(),this.detailShow=!1},onHideWechat:function(){this.getTicket(),this.wechatShow=!1},_initScroll:function(){this.orderScroll=new mt["a"](".ticketList",{scrollY:!0,click:!0})},countDeliveryTicket:function(){return Object(Y["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,b()("/testticketlistlivraison/");case 2:return e=t.sent,t.abrupt("return",e.data.length);case 4:case"end":return t.stop()}}),t)})))()},countEmporterTicket:function(){return Object(Y["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,b()("/testticketlistemporter/");case 2:return e=t.sent,t.abrupt("return",e.data.length);case 4:case"end":return t.stop()}}),t)})))()},createTicket:function(){var t=this;return Object(Y["a"])(regeneratorRuntime.mark((function e(){var i,a,n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.countDeliveryTicket();case 2:return i=e.sent,a={},n="L"+(i+1),s=new Date,a.ticket_id="T"+s.getTime().toString(),a.ticket_time=s.getFullYear().toString()+((s.getMonth()+1).toString().length<2?"0"+(s.getMonth()+1).toString():(s.getMonth()+1).toString())+s.getDate().toString()+(s.getHours().toString().length<2?"0"+s.getHours().toString():s.getHours().toString())+(s.getMinutes().toString().length<2?"0"+s.getMinutes().toString():s.getMinutes().toString())+(s.getSeconds().toString().length<2?"0"+s.getSeconds().toString():s.getSeconds().toString()),a.table_num=n,a.type=2,t.ticketId=a.ticket_id,e.next=13,b()({url:"/testcreatetable/",method:"post",data:a});case 13:return e.abrupt("return",a.ticket_id);case 14:case"end":return e.stop()}}),e)})))()},createEmporterTicket:function(){var t=this;return Object(Y["a"])(regeneratorRuntime.mark((function e(){var i,a,n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.countEmporterTicket();case 2:return i=e.sent,a={},n="E"+(i+1),s=new Date,a.ticket_id="T"+s.getTime().toString(),a.ticket_time=s.getFullYear().toString()+((s.getMonth()+1).toString().length<2?"0"+(s.getMonth()+1).toString():(s.getMonth()+1).toString())+s.getDate().toString()+(s.getHours().toString().length<2?"0"+s.getHours().toString():s.getHours().toString())+(s.getMinutes().toString().length<2?"0"+s.getMinutes().toString():s.getMinutes().toString())+(s.getSeconds().toString().length<2?"0"+s.getSeconds().toString():s.getSeconds().toString()),a.table_num=n,a.type=1,t.ticketId=a.ticket_id,e.next=13,b()({url:"/testcreatetable/",method:"post",data:a});case 13:return e.abrupt("return",a.ticket_id);case 14:case"end":return e.stop()}}),e)})))()},createWechatTicket:function(t){var e=this;return Object(Y["a"])(regeneratorRuntime.mark((function i(){var a,n,s,o;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,e.countDeliveryTicket();case 2:return a=i.sent,n={},s="L"+(a+1),o=new Date,n.ticket_id="T"+o.getTime().toString(),n.ticket_time=o.getFullYear().toString()+((o.getMonth()+1).toString().length<2?"0"+(o.getMonth()+1).toString():(o.getMonth()+1).toString())+o.getDate().toString()+(o.getHours().toString().length<2?"0"+o.getHours().toString():o.getHours().toString())+(o.getMinutes().toString().length<2?"0"+o.getMinutes().toString():o.getMinutes().toString())+(o.getSeconds().toString().length<2?"0"+o.getSeconds().toString():o.getSeconds().toString()),n.table_num=s,n.type=2,n.delivery_platform=5,n.delivery_time=t.deliveryTime,n.client_name=t.clientName,n.client_address=t.address,n.client_telephone=t.tel,n.ticket_note=t.ticketNote,n.ticket_reduction=t.reduction,n.ticket_price=t.ticketPrice.toFixed(2),e.ticketId=n.ticket_id,i.abrupt("return",b()({url:"/testcreatetable/",method:"post",data:n}));case 20:case"end":return i.stop()}}),i)})))()},handleNewTicket:function(){var t=this;return Object(Y["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.wechatTicket={},e.next=3,t.createTicket();case 3:console.log(t),setTimeout((function(){console.log(t.$refs.deliverydetail),t.$refs.deliverydetail.$refs.orderarea.getSubCategory(),t.$refs.deliverydetail.getTicketOrder(),t.$refs.deliverydetail.getTicketBasicDetail()}),0),t.detailShow=!0;case 6:case"end":return e.stop()}}),e)})))()},handleNewEmporterTicket:function(){var t=this;return Object(Y["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.wechatTicket={},e.next=3,t.createEmporterTicket();case 3:console.log(t),setTimeout((function(){console.log(t.$refs.deliverydetail),t.$refs.deliverydetail.$refs.orderarea.getSubCategory(),t.$refs.deliverydetail.getTicketOrder(),t.$refs.deliverydetail.getTicketBasicDetail()}),0),t.detailShow=!0;case 6:case"end":return e.stop()}}),e)})))()},onCreateNewWechatTicket:function(t){var e=this;return Object(Y["a"])(regeneratorRuntime.mark((function i(){var a;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return e.wechatTicket={},i.next=3,e.createWechatTicket(t);case 3:a=i.sent,console.log("onCreateNewWechatTicket内部：",a),setTimeout((function(){e.$refs.deliverydetail.$refs.orderarea.submitWechatOrder(t)}),0),e.wechatTicket=t,setTimeout((function(){console.log(e.wechatTicket),e.$refs.deliverydetail.$refs.orderarea.getSubCategory(),e.$refs.deliverydetail.getTicketOrder(),e.$refs.deliverydetail.getTicketBasicDetail()}),0),e.detailShow=!0;case 9:case"end":return i.stop()}}),i)})))()},getAllDishGroupBy:function(){var t=this;return Object(Y["a"])(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,b.a.get("/testdishordergroupby/0/");case 2:i=e.sent,console.log(i.data),t.groupbyList=i.data,t.groupbyShow=!0;case 6:case"end":return e.stop()}}),e)})))()},onHideGroupby:function(){this.groupbyShow=!1},handleArrangementShow:function(){this.$router.push("/arrangement")},onHideArrangement:function(){this.arrangementShow=!1}},watch:{activeTab:function(){switch(this.activeTab){case 0:console.log("tab===2"),this.getTicket();break;case 1:console.log("tab===1"),this.getTicket();break;case 2:console.log("tab===2"),this.getTicket();break;case 3:console.log("tab===3"),this.getTicket();break;default:this.ticketList=this.ticketList.filter((function(t){return 2===t.type}));break}}}},Ti=Si,Di=(i("ba02"),i("132d")),$i=i("c73b"),Oi=Object(r["a"])(Ti,ne,se,!1,null,"48c63b58",null),Pi=Oi.exports;Ct()(Oi,{VBtn:yt["a"],VIcon:Di["a"],VSpeedDial:$i["a"]});var Ni=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"outer"},[i("div",{staticClass:"topNav"},[i("i",{staticClass:"iconfont icon-zuojiantou",on:{click:t.HideArrangement}}),i("p",{staticClass:"tableNum"},[t._v("调度页面")])]),i("div",{staticClass:"nav"},[i("div",{staticClass:"livreur",class:[0===t.activeTab?"active":""],on:{click:function(e){t.activeTab=0}}},[i("p",[t._v("全部")])]),i("div",{staticClass:"livreur",class:[2===t.activeTab?"active":""],on:{click:function(e){t.activeTab=2}}},[i("p",[t._v("张俊")])]),i("div",{staticClass:"livreur",class:[4===t.activeTab?"active":""],on:{click:function(e){t.activeTab=4}}},[i("p",[t._v("老马")])]),i("div",{staticClass:"livreur",class:[3===t.activeTab?"active":""],on:{click:function(e){t.activeTab=3}}},[i("p",[t._v("阿然")])])]),i("div",{staticClass:"handle"},[i("v-btn",{attrs:{color:"#1E88E5",dark:""}},[i("v-icon",{on:{click:t.openMap}},[t._v("mdi-map-marker-radius-outline")])],1),i("v-btn",{attrs:{color:"#1E88E5",dark:""}},[i("v-icon",{on:{click:t.handlePasteShow}},[t._v("mdi-content-paste")])],1),i("v-btn",{attrs:{color:"#217969",dark:""},on:{click:function(e){return t.distributeOrder(2)}}},[t._v("分配给张")]),i("v-btn",{attrs:{color:"#217969",dark:""},on:{click:function(e){return t.distributeOrder(4)}}},[t._v("分配给马")]),i("v-btn",{attrs:{color:"#217969",dark:""},on:{click:function(e){return t.distributeOrder(3)}}},[t._v("分配给然")])],1),i("div",{staticClass:"handle2"},[i("v-checkbox",{attrs:{color:"#217969"},model:{value:t.allChecked,callback:function(e){t.allChecked=e},expression:"allChecked"}}),t._v(" 全选 ")],1),i("div",{staticClass:"deliveryList"},[i("ul",t._l(t.deliveryList,(function(e,a){return i("li",{key:e.ticket_id},[i("div",{staticClass:"type"},[i("v-checkbox",{attrs:{color:"#217969"},model:{value:e.checked,callback:function(i){t.$set(e,"checked",i)},expression:"data.checked"}})],1),i("div",{staticClass:"detail",on:{click:function(i){return t.handleDetailShow(e)}}},[i("h3",{staticClass:"name"},[t._v(t._s(t.title(e)))]),i("p",{staticClass:"amount"},[t._v("总价："+t._s(e.ticket_price))]),2!==e.type?i("div",{staticClass:"pay"},[i("div",{directives:[{name:"show",rawName:"v-show",value:"0.00"!=e.pay_by_transfer,expression:"data.pay_by_transfer != '0.00'"}],staticClass:"payDetail",staticStyle:{color:"#2CA4B0"}},[i("p",{staticClass:"title"},[t._v("转账")]),i("p",{staticClass:"amount"},[t._v(t._s(e.pay_by_transfer))])]),i("div",{directives:[{name:"show",rawName:"v-show",value:"0.00"!=e.pay_by_cash,expression:"data.pay_by_cash != '0.00'"}],staticClass:"payDetail",staticStyle:{color:"#ff4a4a"}},[i("p",{staticClass:"title"},[t._v("现金")]),i("p",{staticClass:"amount"},[t._v(t._s(e.pay_by_cash))])]),i("div",{directives:[{name:"show",rawName:"v-show",value:"0.00"!=e.pay_by_ticket,expression:"data.pay_by_ticket != '0.00'"}],staticClass:"payDetail",staticStyle:{color:"#217969"}},[i("p",{staticClass:"title"},[t._v("饭票")]),i("p",{staticClass:"amount"},[t._v(t._s(e.pay_by_ticket))])]),i("div",{directives:[{name:"show",rawName:"v-show",value:"0.00"!=e.pay_by_card,expression:"data.pay_by_card != '0.00'"}],staticClass:"payDetail",staticStyle:{color:"#b48608"}},[i("p",{staticClass:"title"},[t._v("刷卡")]),i("p",{staticClass:"amount"},[t._v(t._s(e.pay_by_card))])]),i("div",{directives:[{name:"show",rawName:"v-show",value:"0.00"!=e.pay_by_check,expression:"data.pay_by_check != '0.00'"}],staticClass:"payDetail"},[i("p",{staticClass:"title"},[t._v("支票")]),i("p",{staticClass:"amount"},[t._v(t._s(e.pay_by_check))])]),i("div",{directives:[{name:"show",rawName:"v-show",value:"0.00"!=e.pay_by_wechat,expression:"data.pay_by_wechat != '0.00'"}],staticClass:"payDetail"},[i("p",{staticClass:"title"},[t._v("微信")]),i("p",{staticClass:"amount"},[t._v(t._s(e.pay_by_wechat))])]),i("div",{directives:[{name:"show",rawName:"v-show",value:"0.00"!=e.pay_by_alipay,expression:"data.pay_by_alipay != '0.00'"}],staticClass:"payDetail"},[i("p",{staticClass:"title"},[t._v("阿里")]),i("p",{staticClass:"amount"},[t._v(t._s(e.pay_by_alipay))])])]):2===e.type?i("div",{staticClass:"address"},[t._v(" "+t._s(e.client_address)+" ")]):t._e()]),i("div",{staticClass:"arrow"},[i("i",{staticClass:"iconfont icon-shangjiantou1",on:{click:function(e){return e.stopPropagation(),t.ticketUp(a)}}}),i("i",{staticClass:"iconfont icon-xiajiantou",on:{click:function(e){return e.stopPropagation(),t.ticketDown(a)}}})])])})),0)]),i("transition",{attrs:{name:"testslide"}},[i("delivery-detail",{directives:[{name:"show",rawName:"v-show",value:t.detailShow,expression:"detailShow"}],ref:"deliverydetail",attrs:{detailShow:t.detailShow,ticket_id:t.ticketId},on:{hidedetail:t.onHideDetail}})],1),i("div",{directives:[{name:"show",rawName:"v-show",value:t.pasteShow,expression:"pasteShow"}],staticClass:"readyForCopy"},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.content,expression:"content"}],attrs:{type:"text",placeholder:"复制信息"},domProps:{value:t.content},on:{input:function(e){e.target.composing||(t.content=e.target.value)}}}),i("div",{staticClass:"btnArea"},[i("v-btn",{attrs:{color:"#217969",rounded:"",dark:""},on:{click:function(e){return t.copyToClip(t.content)}}},[t._v("复制")]),i("v-btn",{attrs:{dark:"",rounded:"",color:"#ff4a4a"},on:{click:function(e){t.pasteShow=!1}}},[t._v("关闭")])],1)])],1)},ji=[],Li={props:["arrangementShow"],components:{DeliveryDetail:ai},data:function(){return{deliveryList:[],activeTab:0,ticketId:"",pasteShow:!1,detailShow:!1,platformOption:[{text:"Ricepo",value:1},{text:"HungryP",value:2},{text:"Uber",value:3},{text:"JustEat",value:4},{text:"小程序",value:5},{text:"微信",value:6},{text:"官网",value:7},{text:"微米",value:8},{text:"方圆",value:9},{text:"呱呱",value:10},{text:"Deliveroo",value:11},{text:"无",value:12}]}},mounted:function(){this.getTicket()},computed:{platform:function(){return function(t){switch(t.delivery_platform){case 1:return" - Ricepo";case 2:return" - HungryPanda";case 3:return" - Uber";case 4:return" - JustEat";case 5:return" - 小程序";case 6:return" - 微信";case 7:return" - 官网";case 8:return" - 微米";case 9:return" - 方圆食里";case 10:return" - 呱呱到家";case 11:return" - Deliveroo";case 12:return"";default:return""}}},title:function(){return function(t){return 0===t.type?"桌号："+t.table_num:1===t.type?"打包":"编号："+t.table_num+this.platform(t)+this.deliveryMan(t)}},deliveryMan:function(){return function(t){switch(t.delivery_man){case 1:return"";case 2:return" - 张俊";case 3:return" - 阿然";case 4:return" - 老马";default:return""}}},allChecked:{get:function(){return this.deliveryList.every((function(t){return t.checked}))},set:function(t){this.deliveryList.map((function(e){return e.checked=t}))}},content:function(){var t,e="",i=Object(gt["a"])(this.deliveryList);try{for(i.s();!(t=i.n()).done;){var a=t.value;!0===a.checked&&(e+="=================\n"+a.delivery_time+" | "+a.client_name+" | "+a.client_address+" | "+a.client_telephone+" | "+a.ticket_note+" | "+a.ticket_price+"欧 | \n=================\n\n")}}catch(n){i.e(n)}finally{i.f()}return e},mapAddress:function(){var t,e="https://www.google.fr/maps/dir/86+Rue+de+Richelieu,+75002+Paris",i=Object(gt["a"])(this.deliveryList);try{for(i.s();!(t=i.n()).done;){var a=t.value;!0===a.checked&&(e+="/"+a.client_address.split(" ").join("+"))}}catch(n){i.e(n)}finally{i.f()}return e}},methods:{HideArrangement:function(){this.$router.push("/delivery")},handlePasteShow:function(){this.pasteShow=!0},getTicket:function(){var t=this;return Object(Y["a"])(regeneratorRuntime.mark((function e(){var i,n,s,o,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,b()({url:"/testticketlistnopaied/"});case 2:i=e.sent,0===t.activeTab?t.deliveryList=Object.values(i.data).filter((function(t){return 2===t.type})):t.deliveryList=Object.values(i.data).filter((function(e){return 2===e.type&&e.delivery_man===t.activeTab})),n=0,s=Object(gt["a"])(t.deliveryList);try{for(s.s();!(o=s.n()).done;)c=o.value,a["a"].set(c,"checked",!1),a["a"].set(c,"number",n),n++}catch(r){s.e(r)}finally{s.f()}console.log(t.deliveryList),t.$nextTick((function(){t.deliveryScroll?t.deliveryScroll.refresh():t._initScroll()}));case 9:case"end":return e.stop()}}),e)})))()},distributeOrder:function(t){var e=this;return Object(Y["a"])(regeneratorRuntime.mark((function i(){var a,n,s;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:a=Object(gt["a"])(e.deliveryList),i.prev=1,a.s();case 3:if((n=a.n()).done){i.next=10;break}if(s=n.value,!0!==s.checked){i.next=8;break}return i.next=8,b()({url:"/testpatchticket/".concat(s.ticket_id,"/"),method:"PATCH",data:{delivery_man:t}});case 8:i.next=3;break;case 10:i.next=15;break;case 12:i.prev=12,i.t0=i["catch"](1),a.e(i.t0);case 15:return i.prev=15,a.f(),i.finish(15);case 18:e.getTicket();case 19:case"end":return i.stop()}}),i,null,[[1,12,15,18]])})))()},sortDelivery:function(){function t(t){return function(e,i){var a=e[t],n=i[t];return a-n}}this.deliveryList=this.deliveryList.sort(t("number"))},ticketUp:function(t){0!==t&&(console.log(this.deliveryList[t]),this.deliveryList[t].number-=1,this.deliveryList[t-1].number+=1,this.sortDelivery())},ticketDown:function(t){t<this.deliveryList.length-1&&(this.deliveryList[t].number+=1,this.deliveryList[t+1].number-=1,this.sortDelivery())},_initScroll:function(){this.deliveryScroll=new mt["a"](".deliveryList",{scrollY:!0,click:!0})},openMap:function(){this.copyToClip(this.mapAddress),window.open(this.mapAddress,"_blank")},onHideDetail:function(t){this.getTicket(),this.detailShow=!1},handleDetailShow:function(t){var e=this;console.log(t.ticket_id),this.ticketId=t.ticket_id,setTimeout((function(){e.$refs.deliverydetail.$refs.orderarea.getSubCategory(),e.$refs.deliverydetail.getTicketOrder(),e.$refs.deliverydetail.getTicketBasicDetail()}),0),this.detailShow=!this.detailShow},copyToClip:function(t){var e=document.createElement("textarea");e.value=t,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)}},watch:{activeTab:function(){switch(this.activeTab){case 0:this.getTicket();break;case 2:this.getTicket();break;case 3:this.getTicket();break;case 4:this.getTicket();break;default:break}},arrangementShow:function(){this.arrangementShow&&(console.log("测试：：：："),this.getTicket(this.activeTab))}}},Ai=Li,Fi=(i("1c41"),i("ac7c")),Bi=Object(r["a"])(Ai,Ni,ji,!1,null,"4c22d675",null),Ei=Bi.exports;Ct()(Bi,{VBtn:yt["a"],VCheckbox:Fi["a"],VIcon:Di["a"]});var Ii,Ri,Hi,qi=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"Print"},[i("button",{staticClass:"print-btn",on:{click:t.handleAxios}},[i("span",[t._v(t._s(t.msg))])]),i("ul",{staticClass:"container"},t._l(t.axiosData,(function(e){return i("li",{key:e},[t._v(t._s(e))])})),0)])},Mi=[];function zi(){try{var t=navigator.userAgent;if(t.match(/Windows\sPhone/i))return!0;if(t.match(/iPhone|iPod|iPad/i))return!0;if(t.match(/Android/i))return!0;if(t.match(/Edge\D?\d+/i))return!0;var e=t.match(/Trident\D?\d+/i),i=t.match(/MSIE\D?\d+/i),a=t.match(/OPR\D?\d+/i),n=t.match(/Firefox\D?\d+/i),s=t.match(/x64/i);if(!e&&!i&&s)return!0;if(n){if(n=n[0].match(/\d+/),n[0]>=41||s)return!0}else if(a){if(a=a[0].match(/\d+/),a[0]>=32)return!0}else if(!e&&!i){var o=t.match(/Chrome\D?\d+/i);if(o&&(o=o[0].match(/\d+/),o[0]>=41))return!0}return!1}catch(c){return!0}}function Wi(){if("loading"!==Hi&&"complete"!==Hi){Hi="loading";var t=document.head||document.getElementsByTagName("head")[0]||document.documentElement,e=document.createElement("script"),i=document.createElement("script");e.src="http://localhost:8000/CLodopfuncs.js?priority=1",i.src="http://localhost:18000/CLodopfuncs.js",e.onload=i.onload=function(){Hi="complete"},e.onerror=i.onerror=function(t){Hi="complete"},t.insertBefore(e,t.firstChild),t.insertBefore(i,t.firstChild),Ri=!!(e.src+i.src).match(/\/\/localho|\/\/127.0.0./i)}}function Ui(t,e){var i,a="<br><font color='#FF00FF'>打印控件未安装!点击这里<a href='install_lodop32.exe' target='_self'>执行安装</a>,安装后请刷新页面或重新进入。</font>",n="<br><font color='#FF00FF'>打印控件需要升级!点击这里<a href='install_lodop32.exe' target='_self'>执行升级</a>,升级后请重新进入。</font>",s="<br><font color='#FF00FF'>打印控件未安装!点击这里<a href='install_lodop64.exe' target='_self'>执行安装</a>,安装后请刷新页面或重新进入。</font>",o="<br><font color='#FF00FF'>打印控件需要升级!点击这里<a href='install_lodop64.exe' target='_self'>执行升级</a>,升级后请重新进入。</font>",c="<br><br><font color='#FF00FF'>（注意：如曾安装过Lodop旧版附件npActiveXPLugin,请在【工具】->【附加组件】->【扩展】中先卸它）</font>",r="<br><br><font color='#FF00FF'>(如果此前正常，仅因浏览器升级或重安装而出问题，需重新执行以上安装）</font>",l="<br><font color='#FF00FF'>Web打印服务CLodop未安装启动，点击这里<a href='CLodop_Setup_for_Win32NT.exe' target='_self'>下载执行安装</a>",u="<br>（若此前已安装过，可<a href='CLodop.protocol:setup' target='_self'>点这里直接再次启动</a>）",d="，成功后请刷新本页面。</font>",h="<br><font color='#FF00FF'>Web打印服务CLodop需升级!点击这里<a href='CLodop_Setup_for_Win32NT.exe' target='_self'>执行升级</a>,升级后请刷新页面。</font>";try{var p=navigator.userAgent,v=!!p.match(/MSIE/i)||!!p.match(/Trident/i);if(zi()){try{i=getCLodop()}catch(g){}if(!i&&"complete"!==Hi)return void("loading"===Hi?alert("网页还没下载完毕，请稍等一下再操作."):alert("没有加载CLodop的主js，请先调用loadCLodop过程."));if(!i)return void(document.body.innerHTML=l+(Ri?u:"")+d+document.body.innerHTML);CLODOP.CVERSION<"4.1.2.7"&&(document.body.innerHTML=h+document.body.innerHTML),e&&e.parentNode&&e.parentNode.removeChild(e),t&&t.parentNode&&t.parentNode.removeChild(t)}else{var f=v&&!!p.match(/x64/i);if(t||e?i=v?t:e:Ii?i=Ii:(i=document.createElement("object"),i.setAttribute("width",0),i.setAttribute("height",0),i.setAttribute("style","position:absolute;left:0px;top:-100px;width:0px;height:0px;"),v?i.setAttribute("classid","clsid:2105C259-1E0C-4534-8141-A753534CB4CA"):i.setAttribute("type","application/x-print-lodop"),document.documentElement.appendChild(i),Ii=i),!i||!i.VERSION)return p.indexOf("Chrome")>=0&&(document.body.innerHTML=r+document.body.innerHTML),p.indexOf("Firefox")>=0&&(document.body.innerHTML=c+document.body.innerHTML),document.body.innerHTML=(f?s:a)+document.body.innerHTML,i}return i.VERSION<"6.2.2.6"&&(zi()||(document.body.innerHTML=(f?o:n)+document.body.innerHTML)),i}catch(g){alert("getLodop出错:"+g)}}zi()&&Wi();var Ji={name:"Print",data:function(){return{msg:"点击按钮打印",axiosData:[]}},methods:{btnClickPrint:function(){var t=Ui();t.PRINT_INIT(""),t.ADD_PRINT_HTM(20,2,260,39,"<h1>打印内容</h1>"),t.ADD_PRINT_RECT(10,10,200,400,0,1),t.PRINT()},getDishGroupby0:function(){return Object(Y["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log("执行0"),t.next=3,b.a.get("/testdishordergroupby/0/");case 3:return e=t.sent,t.abrupt("return",e);case 5:case"end":return t.stop()}}),t)})))()},getDishGroupby1:function(){return console.log("执行1"),b.a.get("/testdishordergroupby/0/")},getDishGroupby2:function(){return console.log("执行2"),b.a.get("/testdishordergroupby/0/")},handleAxios:function(){var t=this;return Object(Y["a"])(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.axiosData=[],console.log("开始"),e.next=4,t.getDishGroupby0();case 4:return i=e.sent,t.axiosData.push(i.data[0].dname),e.next=8,t.getDishGroupby1();case 8:return i=e.sent,t.axiosData.push(i.data[1].dname),e.next=12,t.getDishGroupby2();case 12:i=e.sent,t.axiosData.push(i.data[2].dname),console.log("结束"),console.log(t.axiosData);case 16:case"end":return e.stop()}}),e)})))()}}},Vi=Ji,Qi=Object(r["a"])(Vi,qi,Mi,!1,null,null,null),Yi=Qi.exports,Gi=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("v-btn",{on:{click:t.startListen}},[t._v("启动监听")]),i("v-btn",{on:{click:function(e){t.stop=!0}}},[t._v("停止监听")]),i("v-btn",{on:{click:t.getData}},[t._v("直接获取")]),i("v-btn",{on:{click:t.test}},[t._v("测试")])],1)},Zi=[],Ki=(i("99af"),{data:function(){return{inteval:{},stop:!1}},computed:{printContent:function(){return console.log("进入computed内部"),this.$store.state.printList}},methods:{test:function(){return Object(Y["a"])(regeneratorRuntime.mark((function t(){var e,i,a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,b.a.get("/testprintlist/");case 2:e=t.sent,i=JSON.parse(e.data[0].print_content),a=Ui(),n='\n      <div style="width: 100%">\n        <ul style="width: 90%; list-style:none">\n          '.concat(i.orders.map((function(t){return'<li style="list-style:none; margin-left:-30px; width: 100%;\n          min-height: 40px; border: 1px dashed black; font-weight: 800;\n          display: flex; align-items: center">\n            <p style="flex: 1; align-self: center">'.concat(t.quantity,'</p>\n            <p style="flex: 3">').concat(t.dname,'</p>\n            <p style="flex: 3">').concat(t.note,"</p>\n          </li>")})).join(""),"\n        </ul>\n      </div>\n      "),a.PRINT_INIT(""),a.ADD_PRINT_HTML(0,0,"100%","100%",n),a.SET_PRINT_PAGESIZE(3,800,50,""),a.PRINT();case 10:case"end":return t.stop()}}),t)})))()},getData:function(){return Object(Y["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,b.a.get("/testprintlist/");case 2:e=t.sent,console.log(e.data);case 4:case"end":return t.stop()}}),t)})))()},printCuisine:function(t){var e=Ui();console.log(JSON.parse(t.print_content).orders),JSON.parse(t.print_content).orders.map((function(t){return console.log(t.note.length)}));var i='\n      <div style="width: 100%; margin-bottom: 20px">\n        <ul style="width: 90%; list-style:none;">\n          '.concat(JSON.parse(t.print_content).orders.map((function(t){return'<li style="list-style:none; margin-left:-30px; width: 100%;\n          height: '.concat("无备注"===t.note&&t.dname.length<=11?"30px":"45px",'; border: 1px dashed black; font-weight: 800;\n          display: flex; align-items: center">\n            <p style="flex: 0 0 30px; text-align: center;">').concat(t.quantity,'</p>\n            <p style="flex: 5">').concat(t.dname,'</p>\n            <p style="flex: 3; display: ').concat("无备注"===t.note?"none":"block",';">').concat(t.note,"</p>\n          </li>")})).join(""),'\n        </ul>\n      </div>\n      <div style="min-height: 10px"></div>\n      ');e.PRINT_INIT(""),e.ADD_PRINT_HTM(20,0,"100%","100%",i),e.SET_PRINT_PAGESIZE(3,800,50,""),e.PRINT()},printSalle:function(t){var e=Ui();console.log(JSON.parse(t.print_content).orders);var i='\n      <div style="width: 100%;">\n        <div style="width: 90%; margin-left: 10px; font-weight: 800; border-bottom: 1px dotted black;">\n          <span style="display: flex">\n            <p style="display:'.concat(null===JSON.parse(t.print_content).client_name?"none":"block",';">').concat(JSON.parse(t.print_content).client_name,'</p>\n            <p style="margin-left: 10px;display:').concat(null===JSON.parse(t.print_content).client_telephone?"none":"block",';">').concat(JSON.parse(t.print_content).client_telephone,'</p>\n          </span>\n          <p style="margin-top:0px;display: ').concat(null===JSON.parse(t.print_content).delivery_time?"none":"block",';">').concat(JSON.parse(t.print_content).delivery_time,'</p>\n          <p style="margin-top:0px;display:').concat(null===JSON.parse(t.print_content).client_address?"none":"block",';">').concat(JSON.parse(t.print_content).client_address,'</p>\n          <p style="margin-top:0px;display:').concat(null===JSON.parse(t.print_content).ticket_note?"none":"block",';">').concat(JSON.parse(t.print_content).ticket_note,'</p>\n        </div>\n        <ul style="width: 90%; list-style:none">\n          <li  style="list-style:none; margin-left:-30px; margin-top: -10px;\n          width: 100%; min-height: 5px; font-weight: 500;\n          align-items: center">\n            <span style="display: flex">\n              <p style="flex: 1; align-self: center">数量</p>\n              <p style="flex: 4; align-self: center;">名称</p>\n              <p style="flex: 1; align-self: center">价格</p>\n            </span>\n          </li>\n          ').concat(JSON.parse(t.print_content).orders.map((function(t){return'<li style="list-style:none; margin-left:-30px; margin-top: -20px;\n          width: 100%; min-height: 5px; font-weight: 400;\n          align-items: center">\n            <span style="display: flex">\n              <p style="flex: 1; align-self: center">'.concat(t.quantity,'份</p>\n              <p style="flex: 4; align-self: center;">').concat(t.dname,'</p>\n              <p style="flex: 1; align-self: center">').concat((parseFloat(t.quantity)*parseFloat(t.dprice)).toFixed(2),'</p>\n            </span>\n            <p style="display: ').concat("无备注"===t.note?"none":"block",';flex: 3; margin-top:-12px;\n            margin-left: 42px; width: 80%; text-decoration:underline;">').concat(t.note,"</p>\n          </li>")})).join(""),'\n        </ul>\n        <div>\n          <p style="width: 90%; margin-left: 10px; text-align: right; font-weight: 800;">总价: ').concat(JSON.parse(t.print_content).ticket_price,'€</p>\n          <p style="margin-top:-10px;width: 90%; margin-left: 10px; text-align: right; font-size:12px; height: 20px">').concat((7.95*JSON.parse(t.print_content).ticket_price).toFixed(0),'￥</p>\n        </div>\n      </div>\n      <div style="min-height: 10px"></div>\n      ');e.PRINT_INIT(""),e.ADD_PRINT_HTM(30,0,"100%","100%",i),e.SET_PRINT_PAGESIZE(3,800,50,""),e.PRINT()},printGroupby:function(t){var e=Ui();console.log(t),console.log(JSON.parse(t.print_content));var i='\n      <div style="width: 100%">\n        <ul style="width: 90%; list-style:none">\n          '.concat(JSON.parse(t.print_content).map((function(t){return'<li style="list-style:none; margin-left:-30px; width: 100%;\n          border: 1px dashed black; font-weight: 800;\n          height: '.concat(t.note_content?"auto":"30px",';\n          display: flex; align-items: center">\n            <p style="flex: 1; align-self: center; text-align: center; font-size:12px;\n            ">').concat(0===t.emergency?"":"优先",'</p>\n            <p style="flex: 1; align-self: center; text-align: center; font-size:18px;">').concat(t.total_quantity[0],'</p>\n            <p style="flex: 7">').concat(t.dname,'</p>\n            <p style="flex: 5; display: ').concat(t.note_content?"block":"none",';\n            white-space: pre-wrap; text-align: left"">').concat(t.note_content,"</p>\n          </li>")})).join(""),"\n        </ul>\n      </div>\n      ");e.PRINT_INIT(""),e.ADD_PRINT_HTM(30,0,"100%","100%",i),e.SET_PRINT_PAGESIZE(3,800,50,""),e.PREVIEW()},printMain:function(){var t=this;return Object(Y["a"])(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,b.a.get("/testprintlist/");case 2:i=e.sent,console.log(i.data),i.data.length>0?0===i.data[0].print_type?(t.printCuisine(i.data[0]),b()({url:"/testprintlist/".concat(i.data[0].print_id,"/"),method:"DELETE"})):1===i.data[0].print_type?(t.printSalle(i.data[0]),b()({url:"/testprintlist/".concat(i.data[0].print_id,"/"),method:"DELETE"})):2===i.data[0].print_type&&(t.printGroupby(i.data[0]),b()({url:"/testprintlist/".concat(i.data[0].print_id,"/"),method:"DELETE"})):console.log("暂时无单");case 5:case"end":return e.stop()}}),e)})))()},startListen:function(){var t=this;return Object(Y["a"])(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.stop=!1,i=setInterval((function(){!0===t.stop&&clearInterval(i),t.printMain()}),1e3);case 2:case"end":return e.stop()}}),e)})))()}}}),Xi=Ki,ta=Object(r["a"])(Xi,Gi,Zi,!1,null,null,null),ea=ta.exports;Ct()(ta,{VBtn:yt["a"]}),a["a"].use(d["a"]);var ia=[{path:"/",component:m},{path:"/about",name:"About",component:function(){return i.e("about").then(i.bind(null,"f820"))}},{path:"/salle",component:S},{path:"/order/:table_num",component:Nt},{path:"/Management",component:ae},{path:"/delivery",component:Pi},{path:"/arrangement",component:Ei},{path:"/delivery/:ticket_id",component:ai},{path:"/sakinda",component:Yi},{path:"/printlisten",component:ea},{path:"*",component:m}],aa=new d["a"]({mode:"history",base:"/",routes:ia}),na=aa,sa=i("2f62");a["a"].use(sa["a"]);var oa=new sa["a"].Store({state:{isTabbarShow:!0,orderNavShow:!0,table:{tableNum:"",ticketDetail:[],ticketPersonQuantity:"",ticketLength:0,orderLength:0,orderDetail:[],changingOrderDetail:[]},tableId:"",categoryId:"1",dishes:[],selectingDish:[],selectedDish:{},ticketShow:!1,payShow:!1,updateCondition:!1,payCondition:{},wechatTicket:{},printList:[]},mutations:{show:function(t){t.isTabbarShow=!0},hide:function(t){t.isTabbarShow=!1},changeTableNum:function(t,e){t.table.tableNum=e.table_num,t.table.orderLength=e.orderlength,t.table.ticketPersonQuantity=e.person_quantity},changePersonQuantity:function(t,e){console.log("vuex 41行",t),console.log("vuex 42行::::::",e)},changeOrderLength:function(t,e){t.table.orderLength=e},changeTableId:function(t,e){console.log(e),t.tableId=e},changeTicketPersonQuantity:function(t,e){"add"===e?t.table.ticketPersonQuantity+=1:t.table.ticketPersonQuantity-=1},changeCategoryId:function(t,e){t.categoryId=e},changeTicketDetail:function(t,e){t.table.ticketDetail=e},changeOrderDetail:function(t,e){t.table.orderDetail=JSON.parse(JSON.stringify(e)),console.log("orderDetail:::::::",t.table.orderDetail)},changeChangingOrderDetail:function(t,e){t.table.changingOrderDetail=JSON.parse(JSON.stringify(e)),t.table.changingOrderDetail=t.table.changingOrderDetail.map((function(t){return a["a"].set(t,"checked",!1),t}))},changeDishes:function(t,e){t.dishes=e.map((function(t){return a["a"].set(t,"selecting",0),t}))},resetDishes:function(t,e){console.log("resetDish进行中：::::::",e),t.dishes=t.dishes.map((function(t){return a["a"].set(t,"selecting",0),t})),t.table.ticketPersonQuantity=e[0].ticket_personquantity},changeSelectingDish:function(t,e){t.selectingDish=e},changeSelectedDish:function(t,e){t.selectedDish=e.map((function(t){var e={};return e[t.dname]={quantity:t.total_quantity[0],price:t.dprice,tax:t.dtax},e}))},changeTicketShow:function(t){t.ticketShow=!t.ticketShow},hideTicketShow:function(t){console.log("隐藏ticket页面"),t.ticketShow=!1},falseUpdateCondition:function(t){t.updateCondition=!1},trueUpdateCondition:function(t){t.updateCondition=!0},changePayShow:function(t){t.payShow=!t.payShow},hidePayShow:function(t){console.log("隐藏pay页面"),t.payShow=!1},changePayCondition:function(t,e){console.log("进入到changePayCodition中"),console.log("收款信息：：：：：：：：：：",e[0]),a["a"].set(t.payCondition,"virement",e[0].pay_by_transfer),a["a"].set(t.payCondition,"cash",e[0].pay_by_cash),a["a"].set(t.payCondition,"ticket",e[0].pay_by_ticket),a["a"].set(t.payCondition,"card",e[0].pay_by_card),a["a"].set(t.payCondition,"check",e[0].pay_by_check),a["a"].set(t.payCondition,"wechat",e[0].pay_by_wechat),a["a"].set(t.payCondition,"alipay",e[0].pay_by_alipay)},changeOrderNavShow:function(t){t.orderNavShow=!t.orderNavShow},changeWechatTicket:function(t,e){console.log(e),t.wechatTicket=e},changePrintList:function(t,e){t.printList=e,a["a"].set(t.printList,0,e),console.log("printList被改变：：：",t.printList)}},actions:{},modules:{}}),ca=(i("b3e2"),i("d1e78"),i("f309"));a["a"].use(ca["a"]);var ra=new ca["a"]({});a["a"].config.productionTip=!1,new a["a"]({router:na,store:oa,vuetify:ra,render:function(t){return t(u)}}).$mount("#app")},"5c0b":function(t,e,i){"use strict";i("9c0c")},"5c2e":function(t,e,i){"use strict";i("ca55")},"65f8":function(t,e,i){"use strict";i("e837")},7838:function(t,e,i){"use strict";i("0cdd")},"79a2":function(t,e,i){"use strict";i("3148")},"7b00":function(t,e,i){"use strict";i("8167")},"7fc5":function(t,e,i){t.exports=i.p+"static/img/logoxx.21a49d07.jpg"},8167:function(t,e,i){},"8c61":function(t,e,i){"use strict";i("8d6d")},"8d6d":function(t,e,i){},"8e49":function(t,e,i){},"926f":function(t,e,i){},"94f9":function(t,e,i){},"9c0c":function(t,e,i){},"9e5c":function(t,e,i){"use strict";i("edf3")},"9e6f":function(t,e,i){},a1bd:function(t,e,i){},a656:function(t,e,i){"use strict";i("f8c5")},a96d:function(t,e,i){},acd3:function(t,e,i){},ad60:function(t,e,i){"use strict";i("acd3")},b3e2:function(t,e,i){},b5ac:function(t,e,i){"use strict";i("433a")},ba02:function(t,e,i){"use strict";i("c0cc")},bdc2:function(t,e,i){"use strict";i("18ca")},c0cc:function(t,e,i){},c913:function(t,e,i){},c9c7:function(t,e,i){},ca55:function(t,e,i){},cf76:function(t,e,i){"use strict";i("e9e7")},d702:function(t,e,i){"use strict";i("ff6b")},d75e:function(t,e,i){},e837:function(t,e,i){},e9e7:function(t,e,i){},edf3:function(t,e,i){},f8c5:function(t,e,i){},ff6b:function(t,e,i){}});
//# sourceMappingURL=app.7b33dac2.js.map